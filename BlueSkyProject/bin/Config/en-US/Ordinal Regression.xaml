<BSkyCanvas internalhelpfilename="{x:Null}" Title="Ordinal Regression Modeling" ModelClasses="{x:Null}" StatusTextBoxName="{x:Null}" customsyntax="{x:Null}" EditableComboBoxName="{x:Null}" RPackages="MASS" CanExecute="True" PrereqCommandString="{x:Null}" CommandString="{}{{model}} = MASS::polr({{depVar}}~{{indepVars}}, method = '{{method}}', Hess = TRUE, weights ={{weights}}, na.action=na.exclude, data={{%DATASET%}})&#xA;local({&#xA;BSky_Ordinal_Regression_Summary_{{model}} = summary({{model}})&#xA;#Getting the coefficients&#xA;ctable &lt;- coef(BSky_Ordinal_Regression_Summary_{{model}} )&#xA;&#xA;#Creating the p-value from the z-value&#xA;p &lt;- pnorm(abs(ctable[, &quot;t value&quot;]), lower.tail = FALSE) * 2&#xA;&#xA;#Creating the p-value from the t-value&#xA;p2 &lt;- pt(abs(ctable[, &quot;t value&quot;]),lower.tail=FALSE, df={{model}}$df.residual)*2&#xA;&#xA;#Storing the p values in the return structure&#xA;BSky_Ordinal_Regression_Summary_{{model}}[[1]] &lt;- cbind(BSky_Ordinal_Regression_Summary_{{model}}[[1]] , &quot;p.value(z)&quot; = p, &quot;p.value(t)&quot; = p2)&#xA;&#xA;#Displaying results&#xA;BSkyFormat(BSky_Ordinal_Regression_Summary_{{model}})&#xA;&#xA;#Compute Odds ratio and Confidence Interval&#xA;obj1 = cbind(exp(coef({{model}})), exp(confint({{model}})))&#xA;dimnames(obj1)[[2]][1] &lt;- &quot;Odds ratio&quot;&#xA;#Display odds ratio and confidence interval&#xA;BSkyFormat(obj1, singleTableOutputHeader=&quot;Odds Ratio and Confidence Interval&quot;)&#xA;&#xA;}&#xA;)&#xA;#remove({{model}} )" dlgsyntax="{}{{model}} = MASS::polr({{depVar}}~{{indepVars}}, method = '{{method}}', Hess = TRUE, weights ={{weights}}, na.action=na.exclude, data={{%DATASET%}})&#xA;local({&#xA;BSky_Ordinal_Regression_Summary_{{model}} = summary({{model}})&#xA;#Getting the coefficients&#xA;ctable &lt;- coef(BSky_Ordinal_Regression_Summary_{{model}} )&#xA;&#xA;#Creating the p-value from the z-value&#xA;p &lt;- pnorm(abs(ctable[, &quot;t value&quot;]), lower.tail = FALSE) * 2&#xA;&#xA;#Creating the p-value from the t-value&#xA;p2 &lt;- pt(abs(ctable[, &quot;t value&quot;]),lower.tail=FALSE, df={{model}}$df.residual)*2&#xA;&#xA;#Storing the p values in the return structure&#xA;BSky_Ordinal_Regression_Summary_{{model}}[[1]] &lt;- cbind(BSky_Ordinal_Regression_Summary_{{model}}[[1]] , &quot;p.value(z)&quot; = p, &quot;p.value(t)&quot; = p2)&#xA;&#xA;#Displaying results&#xA;BSkyFormat(BSky_Ordinal_Regression_Summary_{{model}})&#xA;&#xA;#Compute Odds ratio and Confidence Interval&#xA;obj1 = cbind(exp(coef({{model}})), exp(confint({{model}})))&#xA;dimnames(obj1)[[2]][1] &lt;- &quot;Odds ratio&quot;&#xA;#Display odds ratio and confidence interval&#xA;BSkyFormat(obj1, singleTableOutputHeader=&quot;Odds Ratio and Confidence Interval&quot;)&#xA;&#xA;}&#xA;)&#xA;#remove({{model}} )" Helpfile="{x:Null}" splitProcessing="True" DatasetRequired="True" MenuLocation="{x:Null}" OutputDefinition="" Width="500" Command="False" Height="368" HelpText="&lt;html&gt;&lt;head&gt;&lt;style type=&quot;text/css&quot;&gt;.c0 { color: Black } .c1 { margin: 0px 0px 10px } .c2 { font-family: 'Courier New'; font-size: 14.6666666666667px } .c3 { font-family: 'Courier New'; font-size: 14.6666666666667px; font-weight: bold } &lt;/style&gt;&lt;/head&gt;&lt;body class=&quot;c0&quot;&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;Ordered Logistic or Probit Regression&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;Description&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;Fits a logistic or probit regression model to an ordered factor response. The default logistic case is proportional odds logistic regression, after which the function is named.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;Usage&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;polr(formula, data, weights, start, ..., subset, na.action,&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;contrasts = NULL, Hess = FALSE, model = TRUE,&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;method = c(&amp;quot;logistic&amp;quot;, &amp;quot;probit&amp;quot;, &amp;quot;loglog&amp;quot;, &amp;quot;cloglog&amp;quot;, &amp;quot;cauchit&amp;quot;))&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;Arguments&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;formula: a formula expression as for regression models, of the form response ~ predictors. The response should be a factor (preferably an ordered factor), which will be interpreted as an ordinal response, with levels ordered as in the factor. The model must have an intercept: attempts to remove one will lead to a warning and be ignored. An offset may be used. See the documentation of formula for other details.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;data: an optional data frame in which to interpret the variables occurring in formula.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;weights: optional case weights in fitting. Default to 1.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;start: initial values for the parameters. This is in the format c(coefficients, zeta): see the Values section.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;... additional arguments to be passed to optim, most often a control argument.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;subset: expression saying which subset of the rows of the data should be used in the fit. All observations are included by default.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;na.action: a function to filter missing data.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;contrasts: a list of contrasts to be used for some or all of the factors appearing as variables in the model formula.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;Hess: logical for whether the Hessian (the observed information matrix) should be returned. Use this if you intend to call summary or vcov on the fit.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;model: logical for whether the model matrix should be returned.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;method: logistic or probit or (complementary) log-log or cauchit (corresponding to a Cauchy latent variable).&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;Details&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;This model is what Agresti (2002) calls a cumulative link model. The basic interpretation is as a coarsened version of a latent variable Y_i which has a logistic or normal or extreme-value or Cauchy distribution with scale parameter one and a linear model for the mean. The ordered factor which is observed is which bin Y_i falls into with breakpoints&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;zeta_0 = -Inf &amp;lt; zeta_1 &amp;lt; … &amp;lt; zeta_K = Inf&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;This leads to the model&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;logit P(Y &amp;lt;= k | x) = zeta_k - eta&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;with logit replaced by probit for a normal latent variable, and eta being the linear predictor, a linear function of the explanatory variables (with no intercept). Note that it is quite common for other software to use the opposite sign for eta (and hence the coefficients beta).&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;In the logistic case, the left-hand side of the last display is the log odds of category k or less, and since these are log odds which differ only by a constant for different k, the odds are proportional. Hence the term proportional odds logistic regression.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;The log-log and complementary log-log links are the increasing functions F^-1(p) = -log(-log(p)) and F^-1(p) = log(-log(1-p)); some call the first the ‘negative log-log’ link. These correspond to a latent variable with the extreme-value distribution for the maximum and minimum respectively.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;A proportional hazards model for grouped survival times can be obtained by using the complementary log-log link with grouping ordered by increasing times.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;predict, summary, vcov, anova, model.frame and an extractAIC method for use with stepAIC (and step). There are also profile and confint methods.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;Value&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;A object of class &amp;quot;polr&amp;quot;. This has components&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;coefficients &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;the coefficients of the linear predictor, which has no intercept.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;zeta &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;the intercepts for the class boundaries.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;deviance &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;the residual deviance.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;fitted.values &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;a matrix, with a column for each level of the response.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;lev &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;the names of the response levels.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;terms &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;the terms structure describing the model.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;df.residual &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;the number of residual degrees of freedoms, calculated using the weights.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;edf &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;the (effective) number of degrees of freedom used by the model&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;n, nobs &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;the (effective) number of observations, calculated using the weights. (nobs is for use by stepAIC.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;call &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;the matched call.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;method &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;the matched method used.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;convergence &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;the convergence code returned by optim.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;niter &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;the number of function and gradient evaluations used by optim.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;lp &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;the linear predictor (including any offset).&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;Hessian &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;(if Hess is true). Note that this is a numerical approximation derived from the optimization process.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;model &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;(if model is true).&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;Note&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;The vcov method uses the approximate Hessian: for reliable results the model matrix should be sensibly scaled with all columns having range the order of one.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;Prior to version 7.3-32, method = &amp;quot;cloglog&amp;quot; confusingly gave the log-log link, implicitly assuming the first response level was the ‘best’.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;References&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;Agresti, A. (2002) Categorical Data. Second edition. Wiley.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;Venables, W. N. and Ripley, B. D. (2002) Modern Applied Statistics with S. Fourth edition. Springer.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;See Also&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;optim, glm, multinom.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c3&quot;&gt;Examples&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;options(contrasts = c(&amp;quot;contr.treatment&amp;quot;, &amp;quot;contr.poly&amp;quot;))&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;house.plr &amp;lt;- polr(Sat ~ Infl + Type + Cont, weights = Freq, data = housing)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;house.plr&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;summary(house.plr, digits = 3)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;## slightly worse fit from&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;summary(update(house.plr, method = &amp;quot;probit&amp;quot;, Hess = TRUE), digits = 3)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;## although it is not really appropriate, can fit&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;summary(update(house.plr, method = &amp;quot;loglog&amp;quot;, Hess = TRUE), digits = 3)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;summary(update(house.plr, method = &amp;quot;cloglog&amp;quot;, Hess = TRUE), digits = 3)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;predict(house.plr, housing, type = &amp;quot;p&amp;quot;)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;addterm(house.plr, ~.^2, test = &amp;quot;Chisq&amp;quot;)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;house.plr2 &amp;lt;- stepAIC(house.plr, ~.^2)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;house.plr2$anova&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;anova(house.plr, house.plr2)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;house.plr &amp;lt;- update(house.plr, Hess=TRUE)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;pr &amp;lt;- profile(house.plr)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;confint(pr)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;plot(pr)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c2&quot;&gt;pairs(pr)&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;" RHelpText="help(polr)" Background="#FFFFFFFF" xmlns="clr-namespace:BSky.Controls;assembly=BSky.Controls" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation"><BSkySourceList CanExecute="True" Syntax="%%VALUE%%" summaryCtrl="False" PrefixTxt="{x:Null}" SepCharacter="{x:Null}" maxNoOfVariables="" SubstituteSettings="NoPrefix|UseComma" ordlevels="" nomlevels="" Name="src" AutoVar="False" renderVars="False" Filter="String|Numeric|Date|Logical|Ordinal|Nominal|Scale" Width="159" Height="319" Left="8" Top="35" Enabled="True" OverwriteSettings="{x:Null}" MoveVariables="False" SelectionMode="Extended"  AllowDrop="True" IsEnabled="True" Focusable="True" av:Canvas.Left="8" av:Canvas.Top="35" av:Grid.IsSharedSizeScope="True"><BSkySourceList.SelectionChangeBehaviour><BehaviourCollection Capacity="0" /></BSkySourceList.SelectionChangeBehaviour><BSkySourceList.Template><av:ControlTemplate TargetType="av:ListBox"><av:Border BorderThickness="1,1,1,1" CornerRadius="4,4,4,4" BorderBrush="#FF888888" Background="#FFFFFFFF"><av:ScrollViewer Margin="1,1,1,1" Focusable="False"><av:StackPanel IsItemsHost="True" Margin="0,0,0,0" /></av:ScrollViewer></av:Border></av:ControlTemplate></BSkySourceList.Template><BSkySourceList.Style><av:Style TargetType="av:ListBox"><av:Style.Resources><av:ResourceDictionary /></av:Style.Resources><av:Setter Property="av:UIElement.Effect"><av:Setter.Value><av:DropShadowEffect Color="#FFF5F5DC" /></av:Setter.Value></av:Setter></av:Style></BSkySourceList.Style></BSkySourceList><BSkyTargetList CanExecute="False" Syntax="%%VALUE%%" summaryCtrl="False" PrefixTxt="{x:Null}" SepCharacter="{x:Null}" maxNoOfVariables="1" SubstituteSettings="NoPrefix|UseComma" ordlevels="" nomlevels="" Name="depVar" AutoVar="True" renderVars="False" Filter="Numeric|Ordinal" Width="140" Height="30" Left="210" Top="116" Enabled="True" OverwriteSettings="{x:Null}" MoveVariables="True" SelectionMode="Extended"  AllowDrop="True" IsEnabled="True" Focusable="True" av:Canvas.Left="210" av:Canvas.Top="116" av:Grid.IsSharedSizeScope="True"><BSkyTargetList.SelectionChangeBehaviour><BehaviourCollection Capacity="4"><Behaviour><Behaviour.Condition><Condition PropertyName="ItemsCount" Value="1" Operator="LessThan" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="depVar" PropertyName="CanExecute" Value="False" /></PropertySettersCollection></Behaviour.Setters></Behaviour><Behaviour><Behaviour.Condition><Condition PropertyName="ItemsCount" Value="1" Operator="Equals" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="depVar" PropertyName="CanExecute" Value="True" /></PropertySettersCollection></Behaviour.Setters></Behaviour></BehaviourCollection></BSkyTargetList.SelectionChangeBehaviour><BSkyTargetList.Template><av:ControlTemplate TargetType="av:ListBox"><av:Border BorderThickness="1,1,1,1" CornerRadius="4,4,4,4" BorderBrush="#FF888888" Background="#FFFFFFFF"><av:ScrollViewer Margin="1,1,1,1" Focusable="False"><av:StackPanel IsItemsHost="True" Margin="0,0,0,0" /></av:ScrollViewer></av:Border></av:ControlTemplate></BSkyTargetList.Template><BSkyTargetList.Style><av:Style TargetType="av:ListBox"><av:Style.Resources><av:ResourceDictionary /></av:Style.Resources><av:Setter Property="av:UIElement.Effect"><av:Setter.Value><av:DropShadowEffect Color="#FFF5F5DC" /></av:Setter.Value></av:Setter></av:Style></BSkyTargetList.Style></BSkyTargetList><BSkyGroupingVariable Name="weights" Width="140" Height="30" Left="210" Top="322" Filter="Numeric|Ordinal|Nominal|Scale" CanExecute="True" SubstituteSettings="NoPrefix|UseComma" Enabled="True" PrefixTxt="{x:Null}" SepCharacter="{x:Null}" nomlevels="" ordlevels="" Syntax="%%VALUE%%" IsEnabled="True" av:Canvas.Left="210" av:Canvas.Top="322"><BSkyGroupingVariable.SelectionChangeBehaviour><BehaviourCollection Capacity="0" /></BSkyGroupingVariable.SelectionChangeBehaviour><SingleItemList CanExecute="True" summaryCtrl="False" PrefixTxt="{x:Null}" SepCharacter="{x:Null}" maxNoOfVariables="" SubstituteSettings="NoPrefix|UseComma" ordlevels="" nomlevels="" AutoVar="True" renderVars="False" Filter="Numeric|Ordinal|Nominal|Scale" Left="NaN" Top="NaN" Enabled="True" OverwriteSettings="{x:Null}" MoveVariables="True" SelectionMode="Extended"  HorizontalAlignment="Stretch" VerticalAlignment="Stretch" AllowDrop="True" Focusable="True" av:Grid.IsSharedSizeScope="True"><SingleItemList.SelectionChangeBehaviour><BehaviourCollection Capacity="0" /></SingleItemList.SelectionChangeBehaviour><SingleItemList.Template><av:ControlTemplate TargetType="av:ListBox"><av:Border BorderThickness="1,1,1,1" CornerRadius="4,4,4,4" BorderBrush="#FF888888" Background="#FFFFFFFF"><av:ScrollViewer Margin="1,1,1,1" Focusable="False"><av:StackPanel IsItemsHost="True" Margin="0,0,0,0" /></av:ScrollViewer></av:Border></av:ControlTemplate></SingleItemList.Template><SingleItemList.Style><av:Style TargetType="av:ListBox"><av:Style.Resources><av:ResourceDictionary /></av:Style.Resources><av:Setter Property="av:UIElement.Effect"><av:Setter.Value><av:DropShadowEffect Color="#FFF5F5DC" /></av:Setter.Value></av:Setter></av:Style></SingleItemList.Style></SingleItemList></BSkyGroupingVariable><BSkyTextBox PrefixTxt="{x:Null}" OverWriteExistingVariables="False" OverwriteSettings="DontPrompt" Name="model" Width="140" Height="30" Left="210" Top="35" SubstituteSettings="TextAsIs" CanExecute="True" Enabled="True" Syntax="%%VALUE%%" TextWrapping="Wrap" AcceptsTab="True" VerticalScrollBarVisibility="Auto" FontFamily="Segoe UI" FontSize="12" VerticalContentAlignment="Center" Template="{av:DynamicResource TextBoxBaseControlTemplate}" AllowDrop="True" IsEnabled="True" av:Canvas.Left="210" av:Canvas.Top="35"><BSkyTextBox.TextChangedBehaviour><BehaviourCollection Capacity="4"><Behaviour><Behaviour.Condition><Condition PropertyName="Text" Value="{x:Null}" Operator="ValidString" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="model" PropertyName="CanExecute" Value="true" /></PropertySettersCollection></Behaviour.Setters></Behaviour><Behaviour><Behaviour.Condition><Condition PropertyName="Text" Value="{x:Null}" Operator="isNullOrEmpty" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="model" PropertyName="CanExecute" Value="false" /></PropertySettersCollection></Behaviour.Setters></Behaviour><Behaviour><Behaviour.Condition><Condition PropertyName="Text" Value="{x:Null}" Operator="IsNumeric" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="model" PropertyName="CanExecute" Value="false" /></PropertySettersCollection></Behaviour.Setters></Behaviour></BehaviourCollection></BSkyTextBox.TextChangedBehaviour><BSkyTextBox.Style><av:Style TargetType="av:TextBox"><av:Style.Resources><av:ResourceDictionary /></av:Style.Resources><av:Setter Property="av:UIElement.Effect"><av:Setter.Value><av:DropShadowEffect Color="#FFF5F5DC" /></av:Setter.Value></av:Setter></av:Style></BSkyTextBox.Style>OrdinalReg</BSkyTextBox><BSkyTextBox PrefixTxt="{x:Null}" OverWriteExistingVariables="False" OverwriteSettings="DontPrompt" Name="indepVars" Width="264" Height="53" Left="219" Top="232" SubstituteSettings="TextAsIs" CanExecute="False" Enabled="True" Syntax="%%VALUE%%" TextWrapping="Wrap" AcceptsTab="True" VerticalScrollBarVisibility="Auto" FontFamily="Segoe UI" FontSize="12" VerticalContentAlignment="Center" Template="{av:DynamicResource TextBoxBaseControlTemplate}" AllowDrop="True" IsEnabled="True" av:Canvas.Left="219" av:Canvas.Top="232" xml:space="preserve"><BSkyTextBox.TextChangedBehaviour><BehaviourCollection Capacity="4"><Behaviour><Behaviour.Condition><Condition PropertyName="Text" Value="{x:Null}" Operator="isNullOrEmpty" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="indepVars" PropertyName="CanExecute" Value="False" /></PropertySettersCollection></Behaviour.Setters></Behaviour><Behaviour><Behaviour.Condition><Condition PropertyName="Text" Value="{x:Null}" Operator="ValidString" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="indepVars" PropertyName="CanExecute" Value="True" /></PropertySettersCollection></Behaviour.Setters></Behaviour></BehaviourCollection></BSkyTextBox.TextChangedBehaviour><BSkyTextBox.Style><av:Style TargetType="av:TextBox"><av:Style.Resources><av:ResourceDictionary /></av:Style.Resources><av:Setter Property="av:UIElement.Effect"><av:Setter.Value><av:DropShadowEffect Color="#FFF5F5DC" /></av:Setter.Value></av:Setter></av:Style></BSkyTextBox.Style></BSkyTextBox><BSkygridForSymbols name="symbols" Width="Auto" Height="Auto" Left="219" Top="195" textBoxName="indepVars" CanExecute="True" Name="symbols" av:Canvas.Left="219" av:Canvas.Top="195"><FormulaButton Name="Button1" Width="25" Height="25" HorizontalAlignment="Left" VerticalAlignment="Top">+</FormulaButton><FormulaButton Name="Button2" Width="25" Height="25" Margin="25,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">*</FormulaButton><FormulaButton Name="Button3" Width="25" Height="25" Margin="50,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">:</FormulaButton><FormulaButton Name="Button4" Width="25" Height="25" Margin="75,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">/</FormulaButton><FormulaButton Name="Button5" Width="40" Height="25" Margin="100,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">%in%</FormulaButton><FormulaButton Name="Button6" Width="25" Height="25" Margin="140,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">-</FormulaButton><FormulaButton Name="Button7" Width="25" Height="25" Margin="165,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">^</FormulaButton><FormulaButton Name="Button8" Width="25" Height="25" Margin="190,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">(</FormulaButton><FormulaButton Name="Button9" Width="25" Height="25" Margin="215,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">)</FormulaButton><FormulaButton Name="Button10" Width="25" Height="25" Margin="240,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">|</FormulaButton></BSkygridForSymbols><BSkyLabel Name="label1" Text="Source Variables" Width="100" Height="28" Left="4" Top="6" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="4" av:Canvas.Top="6">Source Variables</BSkyLabel><BSkyLabel Name="label2" Text="Model Name" Width="92" Height="28" Left="205" Top="6" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="205" av:Canvas.Top="6">Model Name</BSkyLabel><BSkyLabel Name="label3" Text="Dependent Variable" Width="138" Height="27" Left="205" Top="72" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="205" av:Canvas.Top="72">Dependent Variable</BSkyLabel><BSkyVariableMoveButton Name="move" InputList="src" TargetList="depVar" Width="30" Height="30" Left="170" Top="114" Padding="1,1,1,1" Tag="To Dest" Margin="2,2,2,2" av:Canvas.Left="170" av:Canvas.Top="114"><BSkyVariableMoveButton.Effect><av:DropShadowEffect ShadowDepth="0" Color="#C89B5F00" Direction="320" Opacity="1" /></BSkyVariableMoveButton.Effect><av:Grid><av:Image Source="pack://application:,,,/BSky.Controls;component/Resources/left.png" /></av:Grid></BSkyVariableMoveButton><BSkyVariableMoveButton Name="move2" InputList="src" TargetList="indepVars" Width="30" Height="30" Left="170" Top="225" Padding="1,1,1,1" Tag="To Dest" Margin="2,2,2,2" av:Canvas.Left="170" av:Canvas.Top="225"><BSkyVariableMoveButton.Effect><av:DropShadowEffect ShadowDepth="0" Color="#C89B5F00" Direction="320" Opacity="1" /></BSkyVariableMoveButton.Effect><av:Grid><av:Image Source="pack://application:,,,/BSky.Controls;component/Resources/left.png" /></av:Grid></BSkyVariableMoveButton><BSkyGroupBox Name="grp1" HeaderText="Expression" Text="{x:Null}" Width="284" Height="128.6" Left="210" Top="166" Header="Expression" Content="{x:Null}" BorderBrush="#FFA9A9A9" IsHitTestVisible="True" av:Canvas.Left="210" av:Canvas.Top="166" /><BSkyRadioGroup Name="method" HeaderText="Test Method" Text="{x:Null}" Width="105.6" Height="60.8" Left="389" Top="27" Syntax="%%VALUE%%" Header="Test Method" BorderBrush="#FFA9A9A9" IsHitTestVisible="True" av:Canvas.Left="389" av:Canvas.Top="27"><BSkyRadioGroup.RadioButtons><x:Null /></BSkyRadioGroup.RadioButtons><av:StackPanel><BSkyRadioButton GroupName="method" Name="logit" Text="Logit" Width="Auto" Left="0" Top="0" Height="Auto" IsSelected="True" CanExecute="True" Enabled="True" Syntax="logistic" IsChecked="True" FontFamily="Segoe UI" FontSize="12" Style="{av:DynamicResource RadioButtonTemplate}" IsEnabled="True"><BSkyRadioButton.CheckedChangeBehaviour><BehaviourCollection Capacity="0" /></BSkyRadioButton.CheckedChangeBehaviour>Logit</BSkyRadioButton><BSkyRadioButton GroupName="method" Name="probit" Text="Probit" Width="Auto" Left="0" Top="0" Height="Auto" IsSelected="False" CanExecute="True" Enabled="True" Syntax="probit" IsChecked="False" FontFamily="Segoe UI" FontSize="12" Style="{av:DynamicResource RadioButtonTemplate}" IsEnabled="True"><BSkyRadioButton.CheckedChangeBehaviour><BehaviourCollection Capacity="0" /></BSkyRadioButton.CheckedChangeBehaviour>Probit</BSkyRadioButton></av:StackPanel></BSkyRadioGroup><BSkyLabelReqdField Name="rq1" Text="*" Width="15" Height="25" Left="311" Top="67" CanExecute="False" Foreground="#FFFF0000" FontFamily="Segoe UI" FontSize="12" FontWeight="Bold" av:Canvas.Left="311" av:Canvas.Top="67">*</BSkyLabelReqdField><BSkyLabelReqdField Name="rq2" Text="*" Width="15" Height="25" Left="271" Top="156" CanExecute="False" Foreground="#FFFF0000" FontFamily="Segoe UI" FontSize="12" FontWeight="Bold" av:Canvas.Left="271" av:Canvas.Top="156">*</BSkyLabelReqdField><BSkyLabel Name="labcdx" Text="(Note: You must specify an ordered factor variable)" Width="285" Height="26" Left="206" Top="90" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="206" av:Canvas.Top="90">(Note: You must specify an ordered factor variable)</BSkyLabel><BSkyLabelReqdField Name="qaz" Text="*" Width="15" Height="25" Left="276" Top="1" CanExecute="False" Foreground="#FFFF0000" FontFamily="Segoe UI" FontSize="12" FontWeight="Bold" av:Canvas.Left="276" av:Canvas.Top="1">*</BSkyLabelReqdField><BSkyLabel Name="wts" Text="Weights" Width="57.1999999999999" Height="26.6" Left="205.4" Top="296" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="205.4" av:Canvas.Top="296">Weights</BSkyLabel><BSkyVariableMoveButton Name="mv3" InputList="src" TargetList="weights" Width="30" Height="30" Left="170" Top="319.6" Padding="1,1,1,1" Tag="To Dest" Margin="2,2,2,2" av:Canvas.Left="170" av:Canvas.Top="319.6"><BSkyVariableMoveButton.Effect><av:DropShadowEffect ShadowDepth="0" Color="#C89B5F00" Direction="320" Opacity="1" /></BSkyVariableMoveButton.Effect><av:Grid><av:Image Source="pack://application:,,,/BSky.Controls;component/Resources/left.png" /></av:Grid></BSkyVariableMoveButton></BSkyCanvas>