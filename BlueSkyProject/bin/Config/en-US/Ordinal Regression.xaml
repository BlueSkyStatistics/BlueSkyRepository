<BSkyCanvas internalhelpfilename="{assembly:Null}" Title="Ordinal Regression Modeling" ModelClasses="{assembly:Null}" StatusTextBoxName="{assembly:Null}" customsyntax="{assembly:Null}" EditableComboBoxName="{assembly:Null}" RPackages="MASS" CanExecute="True" PrereqCommandString="{assembly:Null}" CommandString="{}{{model}} = polr({{depVar}}~{{indepVars}}, method = '{{method}}', Hess = TRUE, data={{%DATASET%}})&#xA;local({&#xA;BSky_Ordinal_Regression_Summary_{{model}} = summary({{model}})&#xA;#Getting the coefficients&#xA;ctable &lt;- coef(BSky_Ordinal_Regression_Summary_{{model}} )&#xA;&#xA;#Creating the p-value from the z-value&#xA;p &lt;- pnorm(abs(ctable[, &quot;t value&quot;]), lower.tail = FALSE) * 2&#xA;&#xA;#Creating the p-value from the t-value&#xA;p2 &lt;- pt(abs(ctable[, &quot;t value&quot;]),lower.tail=FALSE, df={{model}}$df.residual)*2&#xA;&#xA;#Storing the p values in the return structure&#xA;BSky_Ordinal_Regression_Summary_{{model}}[[1]] &lt;- cbind(BSky_Ordinal_Regression_Summary_{{model}}[[1]] , &quot;p.value(z)&quot; = p, &quot;p.value(t)&quot; = p2)&#xA;&#xA;#Displaying results&#xA;BSkyFormat(BSky_Ordinal_Regression_Summary_{{model}})&#xA;&#xA;#Compute Odds ratio and Confidence Interval&#xA;obj1 = cbind(exp(coef({{model}})), exp(confint({{model}})))&#xA;dimnames(obj1)[[2]][1] &lt;- &quot;Odds ratio&quot;&#xA;#Display odds ratio and confidence interval&#xA;BSkyFormat(obj1, singleTableOutputHeader=&quot;Odds Ratio and Confidence Interval&quot;)&#xA;&#xA;}&#xA;)&#xA;#remove({{model}} )" dlgsyntax="{}{{model}} = polr({{depVar}}~{{indepVars}}, method = '{{method}}', Hess = TRUE, data={{%DATASET%}})&#xA;local({&#xA;BSky_Ordinal_Regression_Summary_{{model}} = summary({{model}})&#xA;#Getting the coefficients&#xA;ctable &lt;- coef(BSky_Ordinal_Regression_Summary_{{model}} )&#xA;&#xA;#Creating the p-value from the z-value&#xA;p &lt;- pnorm(abs(ctable[, &quot;t value&quot;]), lower.tail = FALSE) * 2&#xA;&#xA;#Creating the p-value from the t-value&#xA;p2 &lt;- pt(abs(ctable[, &quot;t value&quot;]),lower.tail=FALSE, df={{model}}$df.residual)*2&#xA;&#xA;#Storing the p values in the return structure&#xA;BSky_Ordinal_Regression_Summary_{{model}}[[1]] &lt;- cbind(BSky_Ordinal_Regression_Summary_{{model}}[[1]] , &quot;p.value(z)&quot; = p, &quot;p.value(t)&quot; = p2)&#xA;&#xA;#Displaying results&#xA;BSkyFormat(BSky_Ordinal_Regression_Summary_{{model}})&#xA;&#xA;#Compute Odds ratio and Confidence Interval&#xA;obj1 = cbind(exp(coef({{model}})), exp(confint({{model}})))&#xA;dimnames(obj1)[[2]][1] &lt;- &quot;Odds ratio&quot;&#xA;#Display odds ratio and confidence interval&#xA;BSkyFormat(obj1, singleTableOutputHeader=&quot;Odds Ratio and Confidence Interval&quot;)&#xA;&#xA;}&#xA;)&#xA;#remove({{model}} )" Helpfile="{assembly:Null}" splitProcessing="True" MenuLocation="{assembly:Null}" OutputDefinition="" Width="500" Command="False" Height="310" HelpText="&lt;html&gt;&lt;head&gt;&lt;style type=&quot;text/css&quot;&gt;.c0 { color: Black } .c1 { margin: 0px 0px 10px } &lt;/style&gt;&lt;/head&gt;&lt;body class=&quot;c0&quot;&gt;&lt;p class=&quot;c1&quot;&gt;Invokes the polr function in the MASS package. Clicking on the R Help button brings up the R help associated with the polr function in a browser.&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;In the coefficient table we calculate the p values using z values and the t values. We also provide the &amp;#160;odds ratio and &amp;#160;the confidence interval on the odds ratio.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;" RHelpText="help(polr)" Background="#FFFFFFFF" xmlns="clr-namespace:BSky.Controls;assembly=BSky.Controls" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation"><BSkySourceList CanExecute="True" Syntax="%%VALUE%%" summaryCtrl="False" PrefixTxt="{assembly:Null}" SepCharacter="{assembly:Null}" maxNoOfVariables="" SubstituteSettings="NoPrefix|UseComma" ordlevels="" nomlevels="" Name="src" AutoVar="False" renderVars="False" Filter="String|Numeric|Date|Logical|Ordinal|Nominal|Scale" Width="159" Height="260" Left="8" Top="35" Enabled="True" OverwriteSettings="{assembly:Null}" MoveVariables="True" SelectionMode="Extended"  AllowDrop="True" IsEnabled="True" Focusable="True" av:Canvas.Left="8" av:Canvas.Top="35" av:Grid.IsSharedSizeScope="True"><BSkySourceList.SelectionChangeBehaviour><BehaviourCollection Capacity="0" /></BSkySourceList.SelectionChangeBehaviour><BSkySourceList.Template><av:ControlTemplate TargetType="av:ListBox"><av:Border BorderThickness="1,1,1,1" CornerRadius="4,4,4,4" BorderBrush="#FF888888" Background="#FFFFFFFF"><av:ScrollViewer Margin="1,1,1,1" Focusable="False"><av:StackPanel IsItemsHost="True" Margin="0,0,0,0" /></av:ScrollViewer></av:Border></av:ControlTemplate></BSkySourceList.Template><BSkySourceList.Style><av:Style TargetType="av:ListBox"><av:Style.Resources><av:ResourceDictionary /></av:Style.Resources><av:Setter Property="av:UIElement.Effect"><av:Setter.Value><av:DropShadowEffect Color="#FFF5F5DC" /></av:Setter.Value></av:Setter></av:Style></BSkySourceList.Style></BSkySourceList><BSkyTargetList CanExecute="False" Syntax="%%VALUE%%" summaryCtrl="False" PrefixTxt="{assembly:Null}" SepCharacter="{assembly:Null}" maxNoOfVariables="1" SubstituteSettings="NoPrefix|UseComma" ordlevels="" nomlevels="" Name="depVar" AutoVar="True" renderVars="False" Filter="Numeric|Ordinal" Width="141" Height="30" Left="210" Top="116" Enabled="True" OverwriteSettings="{assembly:Null}" MoveVariables="True" SelectionMode="Extended"  AllowDrop="True" IsEnabled="True" Focusable="True" av:Canvas.Left="210" av:Canvas.Top="116" av:Grid.IsSharedSizeScope="True"><BSkyTargetList.SelectionChangeBehaviour><BehaviourCollection Capacity="4"><Behaviour><Behaviour.Condition><Condition PropertyName="ItemsCount" Value="1" Operator="LessThan" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="depVar" PropertyName="CanExecute" Value="False" /></PropertySettersCollection></Behaviour.Setters></Behaviour><Behaviour><Behaviour.Condition><Condition PropertyName="ItemsCount" Value="1" Operator="Equals" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="depVar" PropertyName="CanExecute" Value="True" /></PropertySettersCollection></Behaviour.Setters></Behaviour></BehaviourCollection></BSkyTargetList.SelectionChangeBehaviour><BSkyTargetList.Template><av:ControlTemplate TargetType="av:ListBox"><av:Border BorderThickness="1,1,1,1" CornerRadius="4,4,4,4" BorderBrush="#FF888888" Background="#FFFFFFFF"><av:ScrollViewer Margin="1,1,1,1" Focusable="False"><av:StackPanel IsItemsHost="True" Margin="0,0,0,0" /></av:ScrollViewer></av:Border></av:ControlTemplate></BSkyTargetList.Template><BSkyTargetList.Style><av:Style TargetType="av:ListBox"><av:Style.Resources><av:ResourceDictionary /></av:Style.Resources><av:Setter Property="av:UIElement.Effect"><av:Setter.Value><av:DropShadowEffect Color="#FFF5F5DC" /></av:Setter.Value></av:Setter></av:Style></BSkyTargetList.Style></BSkyTargetList><BSkyTextBox PrefixTxt="{assembly:Null}" OverWriteExistingVariables="False" OverwriteSettings="DontPrompt" Name="model" Width="138" Height="30" Left="210" Top="35" SubstituteSettings="TextAsIs" CanExecute="True" Enabled="True" Syntax="%%VALUE%%" TextWrapping="Wrap" AcceptsTab="True" VerticalScrollBarVisibility="Auto" FontFamily="Segoe UI" FontSize="12" VerticalContentAlignment="Center" Template="{av:DynamicResource TextBoxBaseControlTemplate}" AllowDrop="True" IsEnabled="True" av:Canvas.Left="210" av:Canvas.Top="35"><BSkyTextBox.TextChangedBehaviour><BehaviourCollection Capacity="4"><Behaviour><Behaviour.Condition><Condition PropertyName="Text" Value="{assembly:Null}" Operator="ValidString" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="model" PropertyName="CanExecute" Value="true" /></PropertySettersCollection></Behaviour.Setters></Behaviour><Behaviour><Behaviour.Condition><Condition PropertyName="Text" Value="{assembly:Null}" Operator="isNullOrEmpty" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="model" PropertyName="CanExecute" Value="false" /></PropertySettersCollection></Behaviour.Setters></Behaviour><Behaviour><Behaviour.Condition><Condition PropertyName="Text" Value="{assembly:Null}" Operator="IsNumeric" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="model" PropertyName="CanExecute" Value="false" /></PropertySettersCollection></Behaviour.Setters></Behaviour></BehaviourCollection></BSkyTextBox.TextChangedBehaviour><BSkyTextBox.Style><av:Style TargetType="av:TextBox"><av:Style.Resources><av:ResourceDictionary /></av:Style.Resources><av:Setter Property="av:UIElement.Effect"><av:Setter.Value><av:DropShadowEffect Color="#FFF5F5DC" /></av:Setter.Value></av:Setter></av:Style></BSkyTextBox.Style>OrdinalReg</BSkyTextBox><BSkyTextBox PrefixTxt="{assembly:Null}" OverWriteExistingVariables="False" OverwriteSettings="DontPrompt" Name="indepVars" Width="264" Height="53" Left="219" Top="232" SubstituteSettings="TextAsIs" CanExecute="False" Enabled="True" Syntax="%%VALUE%%" TextWrapping="Wrap" AcceptsTab="True" VerticalScrollBarVisibility="Auto" FontFamily="Segoe UI" FontSize="12" VerticalContentAlignment="Center" Template="{av:DynamicResource TextBoxBaseControlTemplate}" AllowDrop="True" IsEnabled="True" av:Canvas.Left="219" av:Canvas.Top="232" xml:space="preserve"><BSkyTextBox.TextChangedBehaviour><BehaviourCollection Capacity="4"><Behaviour><Behaviour.Condition><Condition PropertyName="Text" Value="{assembly:Null}" Operator="isNullOrEmpty" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="indepVars" PropertyName="CanExecute" Value="False" /></PropertySettersCollection></Behaviour.Setters></Behaviour><Behaviour><Behaviour.Condition><Condition PropertyName="Text" Value="{assembly:Null}" Operator="ValidString" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="indepVars" PropertyName="CanExecute" Value="True" /></PropertySettersCollection></Behaviour.Setters></Behaviour></BehaviourCollection></BSkyTextBox.TextChangedBehaviour><BSkyTextBox.Style><av:Style TargetType="av:TextBox"><av:Style.Resources><av:ResourceDictionary /></av:Style.Resources><av:Setter Property="av:UIElement.Effect"><av:Setter.Value><av:DropShadowEffect Color="#FFF5F5DC" /></av:Setter.Value></av:Setter></av:Style></BSkyTextBox.Style></BSkyTextBox><BSkygridForSymbols name="symbols" Width="Auto" Height="Auto" Left="219" Top="195" textBoxName="indepVars" CanExecute="True" Name="symbols" av:Canvas.Left="219" av:Canvas.Top="195"><FormulaButton Name="Button1" Width="25" Height="25" HorizontalAlignment="Left" VerticalAlignment="Top">+</FormulaButton><FormulaButton Name="Button2" Width="25" Height="25" Margin="25,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">*</FormulaButton><FormulaButton Name="Button3" Width="25" Height="25" Margin="50,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">:</FormulaButton><FormulaButton Name="Button4" Width="25" Height="25" Margin="75,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">/</FormulaButton><FormulaButton Name="Button5" Width="40" Height="25" Margin="100,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">%in%</FormulaButton><FormulaButton Name="Button6" Width="25" Height="25" Margin="140,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">-</FormulaButton><FormulaButton Name="Button7" Width="25" Height="25" Margin="165,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">^</FormulaButton><FormulaButton Name="Button8" Width="25" Height="25" Margin="190,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">(</FormulaButton><FormulaButton Name="Button9" Width="25" Height="25" Margin="215,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">)</FormulaButton><FormulaButton Name="Button10" Width="25" Height="25" Margin="240,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">|</FormulaButton></BSkygridForSymbols><BSkyLabel Name="label1" Text="Source Variables" Width="100" Height="28" Left="4" Top="6" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="4" av:Canvas.Top="6">Source Variables</BSkyLabel><BSkyLabel Name="label2" Text="Model Name" Width="92" Height="28" Left="205" Top="6" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="205" av:Canvas.Top="6">Model Name</BSkyLabel><BSkyLabel Name="label3" Text="Dependent Variable" Width="138" Height="27" Left="205" Top="72" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="205" av:Canvas.Top="72">Dependent Variable</BSkyLabel><BSkyVariableMoveButton Name="move" InputList="src" TargetList="depVar" Width="30" Height="30" Left="170" Top="114" Padding="1,1,1,1" Tag="To Dest" Margin="2,2,2,2" av:Canvas.Left="170" av:Canvas.Top="114"><BSkyVariableMoveButton.Effect><av:DropShadowEffect ShadowDepth="0" Color="#C89B5F00" Direction="320" Opacity="1" /></BSkyVariableMoveButton.Effect><av:Grid><av:Image Source="pack://application:,,,/BSky.Controls;component/Resources/left.png" /></av:Grid></BSkyVariableMoveButton><BSkyVariableMoveButton Name="move2" InputList="src" TargetList="indepVars" Width="30" Height="30" Left="170" Top="225" Padding="1,1,1,1" Tag="To Dest" Margin="2,2,2,2" av:Canvas.Left="170" av:Canvas.Top="225"><BSkyVariableMoveButton.Effect><av:DropShadowEffect ShadowDepth="0" Color="#C89B5F00" Direction="320" Opacity="1" /></BSkyVariableMoveButton.Effect><av:Grid><av:Image Source="pack://application:,,,/BSky.Controls;component/Resources/left.png" /></av:Grid></BSkyVariableMoveButton><BSkyGroupBox Name="grp1" HeaderText="Expression" Text="{assembly:Null}" Width="276" Height="131" Left="210" Top="166" Header="Expression" Content="{assembly:Null}" BorderBrush="#FFA9A9A9" IsHitTestVisible="True" av:Canvas.Left="210" av:Canvas.Top="166" /><BSkyRadioGroup Name="method" HeaderText="Test Method" Text="{assembly:Null}" Width="96" Height="60" Left="389" Top="27" Syntax="%%VALUE%%" Header="Test Method" BorderBrush="#FFA9A9A9" IsHitTestVisible="True" av:Canvas.Left="389" av:Canvas.Top="27"><BSkyRadioGroup.RadioButtons><assembly:Null /></BSkyRadioGroup.RadioButtons><av:StackPanel><BSkyRadioButton GroupName="method" Name="logit" Text="Logit" Width="Auto" Left="0" Top="0" Height="Auto" IsSelected="True" CanExecute="True" Enabled="True" Syntax="logistic" IsChecked="True" FontFamily="Segoe UI" FontSize="12" Style="{av:DynamicResource RadioButtonTemplate}" IsEnabled="True"><BSkyRadioButton.CheckedChangeBehaviour><BehaviourCollection Capacity="0" /></BSkyRadioButton.CheckedChangeBehaviour>Logit</BSkyRadioButton><BSkyRadioButton GroupName="method" Name="probit" Text="Probit" Width="Auto" Left="0" Top="0" Height="Auto" IsSelected="False" CanExecute="True" Enabled="True" Syntax="probit" IsChecked="False" FontFamily="Segoe UI" FontSize="12" Style="{av:DynamicResource RadioButtonTemplate}" IsEnabled="True"><BSkyRadioButton.CheckedChangeBehaviour><BehaviourCollection Capacity="0" /></BSkyRadioButton.CheckedChangeBehaviour>Probit</BSkyRadioButton></av:StackPanel></BSkyRadioGroup><BSkyLabelReqdField Name="rq1" Text="*" Width="15" Height="25" Left="311" Top="67" CanExecute="False" Foreground="#FFFF0000" FontFamily="Segoe UI" FontSize="12" FontWeight="Bold" av:Canvas.Left="311" av:Canvas.Top="67">*</BSkyLabelReqdField><BSkyLabelReqdField Name="rq2" Text="*" Width="15" Height="25" Left="271" Top="156" CanExecute="False" Foreground="#FFFF0000" FontFamily="Segoe UI" FontSize="12" FontWeight="Bold" av:Canvas.Left="271" av:Canvas.Top="156">*</BSkyLabelReqdField><BSkyLabel Name="labcdx" Text="(Note: You must specify an ordered factor variable)" Width="285" Height="26" Left="206" Top="90" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="206" av:Canvas.Top="90">(Note: You must specify an ordered factor variable)</BSkyLabel><BSkyLabelReqdField Name="qaz" Text="*" Width="15" Height="25" Left="276" Top="1" CanExecute="False" Foreground="#FFFF0000" FontFamily="Segoe UI" FontSize="12" FontWeight="Bold" av:Canvas.Left="276" av:Canvas.Top="1">*</BSkyLabelReqdField></BSkyCanvas>