<BSkyCanvas internalhelpfilename="{x:Null}" Title="Naive Bayes" ModelClasses="{x:Null}" StatusTextBoxName="{x:Null}" RPackages="caret; klaR" CanExecute="True" PrereqCommandString="{x:Null}" CommandString="{}{{modelname}} &lt;- NULL&#xA;&#xA;{{modelname}} &lt;- NaiveBayes({{dependentvar}}~{{independentvars}}, data={{%DATASET%}}, na.action =na.omit)&#xA;local(&#xA;{&#xA;if( !exists('{{modelname}}' ) || is.null({{modelname}}) )&#xA;{&#xA;cat('\nError: Couldn\'t generate model. The common issue is that, at least one of the predictor contains NA.')&#xA;#set following to false. Because we cant put load refresh inside of any block (like if, else, for etc..)&#xA;}&#xA;else&#xA;{&#xA;#adding dependentvar to naiveBayes model so that it can be used in predict()&#xA;{{modelname}}$dependentvar &lt;&lt;- '{{dependentvar}}'&#xA;&#xA;#Changing headers of scale and factor variables&#xA;tblcount &lt;- length({{modelname}}$tables)&#xA;for(i in 1: tblcount)&#xA;{&#xA;varname &lt;- names({{modelname}}$tables)[[i]]&#xA;varclass &lt;- eval(parse(text=paste('class({{%DATASET%}}$',varname,')', collapse='', sep='')))&#xA;if(varclass == &quot;factor&quot;)&#xA;{&#xA;Grouping = eval( parse( text=paste( 'dimnames({{modelname}}$tables$',varname,')[[1]]', collapse='', sep='') ) )&#xA;Probabilities = eval( parse( text=paste( 'dimnames({{modelname}}$tables$',varname,')[[2]]', collapse='', sep='') ) )&#xA;eval( parse( text=paste( 'dimnames({{modelname}}$tables$',varname,') =NULL', collapse='', sep='') ) )&#xA;eval( parse( text=paste( 'dimnames({{modelname}}$tables$',varname,') = list(Grouping=Grouping, Probabilities = Probabilities)', collapse='', sep='') ) )&#xA;&#xA;}&#xA;else&#xA;{&#xA;colnames({{modelname}}$tables[[i]]) &lt;- c(&quot;Mean&quot;, &quot;Std.Dev&quot;)&#xA;}&#xA;}&#xA;&#xA;for(i in 1: tblcount)&#xA;{&#xA;title &lt;- names({{modelname}}$tables)[[i]] &#xA;BSkyFormat( ({{modelname}}$tables)[[i]] , singleTableOutputHeader=title)&#xA;}&#xA;heading =paste0('Class distribution of variable ', '{{dependentvar}}',collapse='', sep='')&#xA;BSkyFormat({{modelname}}$apriori,singleTableOutputHeader= heading)&#xA;}&#xA;}&#xA;)&#xA;" dlgsyntax="{}{{modelname}} &lt;- NULL&#xA;&#xA;{{modelname}} &lt;- NaiveBayes({{dependentvar}}~{{independentvars}}, data={{%DATASET%}}, na.action =na.omit)&#xA;local(&#xA;{&#xA;if( !exists('{{modelname}}' ) || is.null({{modelname}}) )&#xA;{&#xA;cat('\nError: Couldn\'t generate model. The common issue is that, at least one of the predictor contains NA.')&#xA;#set following to false. Because we cant put load refresh inside of any block (like if, else, for etc..)&#xA;}&#xA;else&#xA;{&#xA;#adding dependentvar to naiveBayes model so that it can be used in predict()&#xA;{{modelname}}$dependentvar &lt;&lt;- '{{dependentvar}}'&#xA;&#xA;#Changing headers of scale and factor variables&#xA;tblcount &lt;- length({{modelname}}$tables)&#xA;for(i in 1: tblcount)&#xA;{&#xA;varname &lt;- names({{modelname}}$tables)[[i]]&#xA;varclass &lt;- eval(parse(text=paste('class({{%DATASET%}}$',varname,')', collapse='', sep='')))&#xA;if(varclass == &quot;factor&quot;)&#xA;{&#xA;Grouping = eval( parse( text=paste( 'dimnames({{modelname}}$tables$',varname,')[[1]]', collapse='', sep='') ) )&#xA;Probabilities = eval( parse( text=paste( 'dimnames({{modelname}}$tables$',varname,')[[2]]', collapse='', sep='') ) )&#xA;eval( parse( text=paste( 'dimnames({{modelname}}$tables$',varname,') =NULL', collapse='', sep='') ) )&#xA;eval( parse( text=paste( 'dimnames({{modelname}}$tables$',varname,') = list(Grouping=Grouping, Probabilities = Probabilities)', collapse='', sep='') ) )&#xA;&#xA;}&#xA;else&#xA;{&#xA;colnames({{modelname}}$tables[[i]]) &lt;- c(&quot;Mean&quot;, &quot;Std.Dev&quot;)&#xA;}&#xA;}&#xA;&#xA;for(i in 1: tblcount)&#xA;{&#xA;title &lt;- names({{modelname}}$tables)[[i]] &#xA;BSkyFormat( ({{modelname}}$tables)[[i]] , singleTableOutputHeader=title)&#xA;}&#xA;heading =paste0('Class distribution of variable ', '{{dependentvar}}',collapse='', sep='')&#xA;BSkyFormat({{modelname}}$apriori,singleTableOutputHeader= heading)&#xA;}&#xA;}&#xA;)&#xA;" Helpfile="{x:Null}" splitProcessing="True" MenuLocation="{x:Null}" OutputDefinition="{x:Null}" Width="550" Command="False" Height="460" HelpText="&lt;html&gt;&lt;head&gt;&lt;style type=&quot;text/css&quot;&gt;.c0 { color: Black } .c1 { margin: 0px 0px 10px } .c2 { font-weight: bold; font-size: 14.6666660308838px; line-height: 1.14999997615814; font-family: 'Arial' } .c3 { font-weight: normal; font-size: 14.6666660308838px; line-height: 1.14999997615814; font-family: 'Arial' } .c4 { margin: 0px 0px 10.0000009536743px; font-size: 11px; font-family: 'Arial' } .c5 { font-weight: normal; font-size: 14.6666660308838px } .c6 { margin: 0px 0px 13.3333339691162px; line-height: 1.14999997615814; font-size: 11px; font-family: 'Arial' } .c7 { font-weight: bold; font-size: 14.6666660308838px } .c8 { margin: 0px 0px 10.0000009536743px; line-height: 1.14999997615814; font-size: 11px; font-family: 'Arial' } .c9 { font-weight: bold; font-size: 14.6666660308838px; font-family: 'Arial' } .c10 { font-weight: normal; font-size: 14.6666660308838px; font-family: 'Arial' } &lt;/style&gt;&lt;/head&gt;&lt;body class=&quot;c0&quot;&gt;&lt;p class=&quot;c1&quot;&gt;&amp;#x200b;&lt;span class=&quot;c2&quot;&gt;Description:&lt;/span&gt;&lt;span class=&quot;c3&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c4&quot;&gt;&lt;span class=&quot;c5&quot;&gt;Computes the conditional a-posterior probabilities of a categorical class variable given independent predictor variables using the Bayes rule.&amp;#160;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;Usage:&lt;/span&gt;&lt;span class=&quot;c5&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c5&quot;&gt;NaiveBayes(formula, data, ..., &amp;#160;na.action = na.pass)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;Arguments:&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c5&quot;&gt;formula : a formula of the form class ~ x1 + x2 + .... Interactions are not allowed.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c5&quot;&gt;data: a data frame of predictors (caegorical and/or numeric).&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c4&quot;&gt;&lt;span class=&quot;c5&quot;&gt;na.action : a function to specify the action to be taken if NAs are found. The default action is not to count them for the computation of the probability factors. An alternative is na.omit, which leads to rejection of cases with missing values on any required variable. (NOTE: If given, this argument must be named.)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c5&quot;&gt;...  : arguments passed to density.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c8&quot;&gt;&lt;span class=&quot;c5&quot;&gt;&amp;#160;&lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;Package: BlueSky, klaR, caret&lt;/span&gt;&lt;span class=&quot;c9&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;span class=&quot;c9&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c8&quot;&gt;&lt;span class=&quot;c9&quot;&gt;&amp;#160;Other:&amp;#160;&lt;/span&gt;&lt;span class=&quot;c10&quot;&gt;Click the R Help button to get detailed R help&lt;/span&gt;&lt;span class=&quot;c10&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;span class=&quot;c10&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;" RHelpText="help(NaiveBayes)" Background="#FFEEEFFF" xmlns="clr-namespace:BSky.Controls;assembly=BSky.Controls" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation"><BSkySourceList CanExecute="True" Syntax="%%VALUE%%" summaryCtrl="False" PrefixTxt="{x:Null}" SepCharacter="{x:Null}" maxNoOfVariables="" SubstituteSettings="NoPrefix|UseComma" ordlevels="" nomlevels="" Name="src" AutoVar="False" renderVars="False" Filter="String|Numeric|Date|Logical|Ordinal|Nominal|Scale" Width="245" Height="425" Left="7" Top="28" Enabled="True" OverwriteSettings="{x:Null}" MoveVariables="True" SelectionMode="Extended"  AllowDrop="True" IsEnabled="True" Focusable="True" av:Canvas.Left="7" av:Canvas.Top="28" av:Grid.IsSharedSizeScope="True"><BSkySourceList.SelectionChangeBehaviour><BehaviourCollection Capacity="0" /></BSkySourceList.SelectionChangeBehaviour><BSkySourceList.Template><av:ControlTemplate TargetType="av:ListBox"><av:Border BorderThickness="1,1,1,1" CornerRadius="4,4,4,4" BorderBrush="#FF888888" Background="#FFFFFFFF"><av:ScrollViewer Margin="1,1,1,1" Focusable="False"><av:StackPanel IsItemsHost="True" Margin="0,0,0,0" /></av:ScrollViewer></av:Border></av:ControlTemplate></BSkySourceList.Template><BSkySourceList.Style><av:Style TargetType="av:ListBox"><av:Style.Resources><av:ResourceDictionary /></av:Style.Resources><av:Setter Property="av:UIElement.Effect"><av:Setter.Value><av:DropShadowEffect Color="#FFF5F5DC" /></av:Setter.Value></av:Setter></av:Style></BSkySourceList.Style></BSkySourceList><BSkyTargetList CanExecute="False" Syntax="%%VALUE%%" summaryCtrl="False" PrefixTxt="" SepCharacter="" maxNoOfVariables="" SubstituteSettings="NoPrefix|UsePlus" ordlevels="" nomlevels="" Name="independentvars" AutoVar="True" renderVars="False" Filter="Numeric|Logical|Ordinal|Nominal|Scale" Width="240" Height="297" Left="305" Top="157" Enabled="True" OverwriteSettings="{x:Null}" MoveVariables="True" SelectionMode="Extended"  AllowDrop="True" IsEnabled="True" Focusable="True" av:Canvas.Left="305" av:Canvas.Top="157" av:Grid.IsSharedSizeScope="True"><BSkyTargetList.SelectionChangeBehaviour><BehaviourCollection Capacity="4"><Behaviour><Behaviour.Condition><Condition PropertyName="ItemsCount" Value="0" Operator="Equals" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="independentvars" PropertyName="CanExecute" Value="False" /></PropertySettersCollection></Behaviour.Setters></Behaviour><Behaviour><Behaviour.Condition><Condition PropertyName="ItemsCount" Value="0" Operator="GreaterThan" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="independentvars" PropertyName="CanExecute" Value="True" /></PropertySettersCollection></Behaviour.Setters></Behaviour></BehaviourCollection></BSkyTargetList.SelectionChangeBehaviour><BSkyTargetList.Template><av:ControlTemplate TargetType="av:ListBox"><av:Border BorderThickness="1,1,1,1" CornerRadius="4,4,4,4" BorderBrush="#FF888888" Background="#FFFFFFFF"><av:ScrollViewer Margin="1,1,1,1" Focusable="False"><av:StackPanel IsItemsHost="True" Margin="0,0,0,0" /></av:ScrollViewer></av:Border></av:ControlTemplate></BSkyTargetList.Template><BSkyTargetList.Style><av:Style TargetType="av:ListBox"><av:Style.Resources><av:ResourceDictionary /></av:Style.Resources><av:Setter Property="av:UIElement.Effect"><av:Setter.Value><av:DropShadowEffect Color="#FFF5F5DC" /></av:Setter.Value></av:Setter></av:Style></BSkyTargetList.Style></BSkyTargetList><BSkyGroupingVariable Name="dependentvar" Width="240" Height="37" Left="305" Top="91" Filter="Numeric|Ordinal|Nominal" CanExecute="False" SubstituteSettings="NoPrefix|UseComma" Enabled="True" PrefixTxt="{x:Null}" SepCharacter="{x:Null}" nomlevels="" ordlevels="" Syntax="%%VALUE%%" IsEnabled="True" av:Canvas.Left="305" av:Canvas.Top="91"><BSkyGroupingVariable.SelectionChangeBehaviour><BehaviourCollection Capacity="4"><Behaviour><Behaviour.Condition><Condition PropertyName="ItemsCount" Value="0" Operator="Equals" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="dependentvar" PropertyName="CanExecute" Value="False" /></PropertySettersCollection></Behaviour.Setters></Behaviour><Behaviour><Behaviour.Condition><Condition PropertyName="ItemsCount" Value="1" Operator="Equals" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="dependentvar" PropertyName="CanExecute" Value="True" /></PropertySettersCollection></Behaviour.Setters></Behaviour></BehaviourCollection></BSkyGroupingVariable.SelectionChangeBehaviour><SingleItemList CanExecute="False" summaryCtrl="False" PrefixTxt="{x:Null}" SepCharacter="{x:Null}" maxNoOfVariables="" SubstituteSettings="NoPrefix|UseComma" ordlevels="" nomlevels="" AutoVar="True" renderVars="False" Filter="Numeric|Ordinal|Nominal" Left="NaN" Top="NaN" Enabled="True" OverwriteSettings="{x:Null}" MoveVariables="True" SelectionMode="Extended"  HorizontalAlignment="Stretch" VerticalAlignment="Stretch" AllowDrop="True" Focusable="True" av:Grid.IsSharedSizeScope="True"><SingleItemList.SelectionChangeBehaviour><BehaviourCollection Capacity="4"><Behaviour><Behaviour.Condition><Condition PropertyName="ItemsCount" Value="0" Operator="Equals" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="dependentvar" PropertyName="CanExecute" Value="False" /></PropertySettersCollection></Behaviour.Setters></Behaviour><Behaviour><Behaviour.Condition><Condition PropertyName="ItemsCount" Value="1" Operator="Equals" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="dependentvar" PropertyName="CanExecute" Value="True" /></PropertySettersCollection></Behaviour.Setters></Behaviour></BehaviourCollection></SingleItemList.SelectionChangeBehaviour><SingleItemList.Template><av:ControlTemplate TargetType="av:ListBox"><av:Border BorderThickness="1,1,1,1" CornerRadius="4,4,4,4" BorderBrush="#FF888888" Background="#FFFFFFFF"><av:ScrollViewer Margin="1,1,1,1" Focusable="False"><av:StackPanel IsItemsHost="True" Margin="0,0,0,0" /></av:ScrollViewer></av:Border></av:ControlTemplate></SingleItemList.Template><SingleItemList.Style><av:Style TargetType="av:ListBox"><av:Style.Resources><av:ResourceDictionary /></av:Style.Resources><av:Setter Property="av:UIElement.Effect"><av:Setter.Value><av:DropShadowEffect Color="#FFF5F5DC" /></av:Setter.Value></av:Setter></av:Style></SingleItemList.Style></SingleItemList></BSkyGroupingVariable><BSkyLabel Name="lbl1" Text="Source Variables:" Width="109" Height="24" Left="4" Top="5" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="4" av:Canvas.Top="5">Source Variables:</BSkyLabel><BSkyLabel Name="lbl2" Text="Dependent Variable (one):" Width="180" Height="27" Left="301" Top="65" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="301" av:Canvas.Top="65">Dependent Variable (one):</BSkyLabel><BSkyLabel Name="lbl3" Text="Independent Variables(one or more):" Width="220" Height="26" Left="301" Top="133" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="301" av:Canvas.Top="133">Independent Variables(one or more):</BSkyLabel><BSkyVariableMoveButton Name="move1" InputList="src" TargetList="dependentvar" Width="30" Height="30" Left="262" Top="91" Padding="1,1,1,1" Tag="To Dest" Margin="2,2,2,2" av:Canvas.Left="262" av:Canvas.Top="91"><BSkyVariableMoveButton.Effect><av:DropShadowEffect ShadowDepth="0" Color="#C89B5F00" Direction="320" Opacity="1" /></BSkyVariableMoveButton.Effect><av:Grid><av:Image Source="pack://application:,,,/BSky.Controls;component/Resources/left.png" /></av:Grid></BSkyVariableMoveButton><BSkyVariableMoveButton Name="move2" InputList="src" TargetList="independentvars" Width="30" Height="30" Left="262" Top="157" Padding="1,1,1,1" Tag="To Dest" Margin="2,2,2,2" av:Canvas.Left="262" av:Canvas.Top="157"><BSkyVariableMoveButton.Effect><av:DropShadowEffect ShadowDepth="0" Color="#C89B5F00" Direction="320" Opacity="1" /></BSkyVariableMoveButton.Effect><av:Grid><av:Image Source="pack://application:,,,/BSky.Controls;component/Resources/left.png" /></av:Grid></BSkyVariableMoveButton><BSkyLabel Name="ll1" Text="Enter model name:" Width="186" Height="29" Left="302" Top="5" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="302" av:Canvas.Top="5">Enter model name:</BSkyLabel><BSkyTextBox PrefixTxt="{x:Null}" OverWriteExistingVariables="False" OverwriteSettings="DontPrompt" Name="modelname" Width="240" Height="30" Left="305" Top="28" SubstituteSettings="TextAsIs" CanExecute="True" Enabled="True" Syntax="%%VALUE%%" TextWrapping="Wrap" AcceptsTab="True" VerticalScrollBarVisibility="Auto" FontFamily="Segoe UI" FontSize="12" VerticalContentAlignment="Center" Template="{av:DynamicResource TextBoxBaseControlTemplate}" AllowDrop="True" IsEnabled="True" av:Canvas.Left="305" av:Canvas.Top="28"><BSkyTextBox.TextChangedBehaviour><BehaviourCollection Capacity="4"><Behaviour><Behaviour.Condition><Condition PropertyName="Text" Value="{x:Null}" Operator="isNullOrEmpty" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="modelname" PropertyName="CanExecute" Value="False" /></PropertySettersCollection></Behaviour.Setters></Behaviour><Behaviour><Behaviour.Condition><Condition PropertyName="Text" Value="{x:Null}" Operator="ValidString" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="modelname" PropertyName="CanExecute" Value="True" /></PropertySettersCollection></Behaviour.Setters></Behaviour></BehaviourCollection></BSkyTextBox.TextChangedBehaviour><BSkyTextBox.Style><av:Style TargetType="av:TextBox"><av:Style.Resources><av:ResourceDictionary /></av:Style.Resources><av:Setter Property="av:UIElement.Effect"><av:Setter.Value><av:DropShadowEffect Color="#FFF5F5DC" /></av:Setter.Value></av:Setter></av:Style></BSkyTextBox.Style>NaiveBayesModel1</BSkyTextBox></BSkyCanvas>