<BSkyCanvas internalhelpfilename="{x:Null}" Title="Correlation Matrix" ModelClasses="{x:Null}" StatusTextBoxName="{x:Null}" customsyntax="{x:Null}" EditableComboBoxName="{x:Null}" RPackages="stats" CanExecute="True" PrereqCommandString="{x:Null}" CommandString="BSky_Correlation_Matrix_{{gpbox2}} = cor({{%DATASET%}}[,c({{tvarbox1}})], use=&quot;complete.obs&quot;, method = &quot;{{gpbox2}}&quot;)&#xA;&#xA;BSkyFormat(BSky_Correlation_Matrix_{{gpbox2}}, singleTableOutputHeader='Correlation Matrix')&#xA;#remove(BSky_Correlation_Matrix_{{gpbox2}})&#xA;" dlgsyntax="BSky_Correlation_Matrix_{{gpbox2}} = cor({{%DATASET%}}[,c({{tvarbox1}})], use=&quot;complete.obs&quot;, method = &quot;{{gpbox2}}&quot;)&#xA;&#xA;BSkyFormat(BSky_Correlation_Matrix_{{gpbox2}}, singleTableOutputHeader='Correlation Matrix')&#xA;#remove(BSky_Correlation_Matrix_{{gpbox2}})&#xA;" Helpfile="" splitProcessing="True" MenuLocation="{x:Null}" OutputDefinition="{x:Null}" Width="382" Command="False" Height="233" HelpText="&lt;html&gt;&lt;head&gt;&lt;style type=&quot;text/css&quot;&gt;.c0 { color: Black } .c1 { margin: 0px 0px 10px } .c2 { margin: 0px 0px 11px; font-size: 12px; font-weight: bold } .c3 { font-family: 'Courier New'; font-size: 12px } .c4 { font-size: 12px } .c5 { font-style: italic; font-size: 12px } .c6 { vertical-align: middle } .c7 { vertical-align: top } .c8 { margin: 0px 0px 12px } .c9 { color: Blue; text-decoration: underline; font-family: 'Courier New' } &lt;/style&gt;&lt;/head&gt;&lt;body class=&quot;c0&quot;&gt;&lt;p class=&quot;c1&quot;&gt;&amp;#x200b;&lt;/p&gt;&lt;div&gt;&lt;span class=&quot;c2&quot;&gt;Description&lt;/span&gt;&lt;/div&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;var&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;,&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;cov&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;and&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;cor&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;compute the variance of&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;and the covariance or correlation of&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;and&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;y&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;if these are vectors. If&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;and&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;y&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;are matrices then the covariances (or correlations) between the columns of&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;and the columns of&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;y&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;are computed.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;cov2cor&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;scales a covariance matrix into the corresponding correlation matrix&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c5&quot;&gt;efficiently&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;.&lt;/span&gt;&lt;/p&gt;&lt;div&gt;&lt;span class=&quot;c2&quot;&gt;Usage&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;var(x, y = NULL, na.rm = FALSE, use)&lt;br/&gt;&lt;br/&gt;cov(x, y = NULL, use = &amp;quot;everything&amp;quot;,&lt;br/&gt; &amp;#160;&amp;#160;&amp;#160;method = c(&amp;quot;pearson&amp;quot;, &amp;quot;kendall&amp;quot;, &amp;quot;spearman&amp;quot;))&lt;br/&gt;&lt;br/&gt;cor(x, y = NULL, use = &amp;quot;everything&amp;quot;,&lt;br/&gt; &amp;#160;&amp;#160;&amp;#160;method = c(&amp;quot;pearson&amp;quot;, &amp;quot;kendall&amp;quot;, &amp;quot;spearman&amp;quot;))&lt;br/&gt;&lt;br/&gt;cov2cor(V)&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span class=&quot;c2&quot;&gt;Arguments&lt;/span&gt;&lt;/div&gt;&lt;table&gt;&lt;col/&gt;&lt;col/&gt;&lt;tbody class=&quot;c6&quot;&gt;&lt;tr class=&quot;c7&quot;&gt;&lt;td class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;&lt;td class=&quot;c7&quot;&gt;&lt;p class=&quot;c8&quot;&gt;&lt;span class=&quot;c4&quot;&gt;a numeric vector, matrix or data frame.&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;c7&quot;&gt;&lt;td class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;y&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;&lt;td class=&quot;c7&quot;&gt;&lt;p class=&quot;c8&quot;&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;NULL&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;(default) or a vector, matrix or data frame with compatible dimensions to&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;. The default is equivalent to&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;y = x&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;(but more efficient).&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;c7&quot;&gt;&lt;td class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;na.rm&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;&lt;td class=&quot;c7&quot;&gt;&lt;p class=&quot;c8&quot;&gt;&lt;span class=&quot;c4&quot;&gt;logical. Should missing values be removed?&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;c7&quot;&gt;&lt;td class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;use&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;&lt;td class=&quot;c7&quot;&gt;&lt;p class=&quot;c8&quot;&gt;&lt;span class=&quot;c4&quot;&gt;an optional character string giving a method for computing covariances in the presence of missing values. This must be (an abbreviation of) one of the strings&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;&amp;quot;everything&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;,&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;&amp;quot;all.obs&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;,&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;&amp;quot;complete.obs&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;,&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;&amp;quot;na.or.complete&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;, or&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;&amp;quot;pairwise.complete.obs&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;.&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;c7&quot;&gt;&lt;td class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;method&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;&lt;td class=&quot;c7&quot;&gt;&lt;p class=&quot;c8&quot;&gt;&lt;span class=&quot;c4&quot;&gt;a character string indicating which correlation coefficient (or covariance) is to be computed. One of&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;&amp;quot;pearson&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;(default),&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;&amp;quot;kendall&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;, or&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;&amp;quot;spearman&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;: can be abbreviated.&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;c7&quot;&gt;&lt;td class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;V&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;&lt;td class=&quot;c7&quot;&gt;&lt;p class=&quot;c8&quot;&gt;&lt;span class=&quot;c4&quot;&gt;symmetric numeric matrix, usually positive definite such as a covariance matrix.&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;div&gt;&lt;span class=&quot;c2&quot;&gt;Details&lt;/span&gt;&lt;/div&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c4&quot;&gt;For&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;cov&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;and&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;cor&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;one must&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c5&quot;&gt;either&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;give a matrix or data frame for&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c5&quot;&gt;or&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;give both&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;and&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;y&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c4&quot;&gt;The inputs must be numeric (as determined by&amp;#160;&lt;/span&gt;&lt;a href=&quot;http://127.0.0.1:21647/library/stats/help/is.numeric&quot; class=&quot;c9&quot;&gt;&lt;span class=&quot;c4&quot;&gt;is.numeric&lt;/span&gt;&lt;/a&gt;&lt;span class=&quot;c4&quot;&gt;: logical values are also allowed for historical compatibility): the&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;&amp;quot;kendall&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;and&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;&amp;quot;spearman&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;methods make sense for ordered inputs but&amp;#160;&lt;/span&gt;&lt;a href=&quot;http://127.0.0.1:21647/library/stats/help/xtfrm&quot; class=&quot;c9&quot;&gt;&lt;span class=&quot;c4&quot;&gt;xtfrm&lt;/span&gt;&lt;/a&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;can be used to find a suitable prior transformation to numbers.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;var&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;is just another interface to&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;cov&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;, where&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;na.rm&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;is used to determine the default for&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;use&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;when that is unspecified. If&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;na.rm&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;is&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;TRUE&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;then the complete observations (rows) are used (&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;use = &amp;quot;na.or.complete&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;) to compute the variance. Otherwise, by default&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;use = &amp;quot;everything&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c4&quot;&gt;If&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;use&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;is&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;&amp;quot;everything&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;,&amp;#160;&lt;/span&gt;&lt;a href=&quot;http://127.0.0.1:21647/library/stats/help/NA&quot; class=&quot;c9&quot;&gt;&lt;span class=&quot;c4&quot;&gt;NA&lt;/span&gt;&lt;/a&gt;&lt;span class=&quot;c4&quot;&gt;s will propagate conceptually, i.e., a resulting value will be&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;NA&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;whenever one of its contributing observations is&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;NA&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;.&lt;br/&gt; If&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;use&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;is&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;&amp;quot;all.obs&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;, then the presence of missing observations will produce an error. If&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;use&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;is&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;&amp;quot;complete.obs&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;then missing values are handled by casewise deletion (and if there are no complete cases, that gives an error). &lt;br/&gt;&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;&amp;quot;na.or.complete&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;is the same unless there are no complete cases, that gives&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;NA&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;. Finally, if&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;use&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;has the value&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;&amp;quot;pairwise.complete.obs&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;then the correlation or covariance between each pair of variables is computed using all complete pairs of observations on those variables. This can result in covariance or correlation matrices which are not positive semi-definite, as well as&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;NA&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;entries if there are no complete pairs for that pair of variables. For&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;cov&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;and&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;var&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;,&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;&amp;quot;pairwise.complete.obs&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;only works with the&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;&amp;quot;pearson&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;method. Note that (the equivalent of)&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;var(double(0), use = *)&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;gives&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;NA&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;for&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;use = &amp;quot;everything&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;and&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;&amp;quot;na.or.complete&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;, and gives an error in the other cases.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c4&quot;&gt;The denominator&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c5&quot;&gt;n - 1&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;is used which gives an unbiased estimator of the (co)variance for i.i.d. observations. These functions return&amp;#160;&lt;/span&gt;&lt;a href=&quot;http://127.0.0.1:21647/library/stats/help/NA&quot; class=&quot;c9&quot;&gt;&lt;span class=&quot;c4&quot;&gt;NA&lt;/span&gt;&lt;/a&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;when there is only one observation (whereas S-PLUS has been returning&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;NaN&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;), and fail if&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;has length zero.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c4&quot;&gt;For&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;cor()&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;, if&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;is&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;&amp;quot;kendall&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;or&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;&amp;quot;spearman&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;, Kendall's&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c5&quot;&gt;tau&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;or Spearman's&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c5&quot;&gt;rho&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;statistic is used to estimate a rank-based measure of association. These are more robust and have been recommended if the data do not necessarily come from a bivariate normal distribution.&lt;br/&gt; For&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;cov()&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;, a non-Pearson method is unusual but available for the sake of completeness. Note that&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;&amp;quot;spearman&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;basically computes&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;cor(R(x), R(y))&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;(or&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;cov(., .)&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;) where&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;R(u) := rank(u, na.last = &amp;quot;keep&amp;quot;)&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;. In the case of missing values, the ranks are calculated depending on the value of&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;use&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;, either based on complete observations, or based on pairwise completeness with reranking for each pair.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c4&quot;&gt;When there are ties, Kendall's&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c5&quot;&gt;tau_b&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;is computed, as proposed by Kendall (1945).&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c4&quot;&gt;Scaling a covariance matrix into a correlation one can be achieved in many ways, mathematically most appealing by multiplication with a diagonal matrix from left and right, or more efficiently by using&amp;#160;&lt;/span&gt;&lt;a href=&quot;http://127.0.0.1:21647/library/stats/help/sweep&quot; class=&quot;c9&quot;&gt;&lt;span class=&quot;c4&quot;&gt;sweep&lt;/span&gt;&lt;/a&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;(.., FUN = &amp;quot;/&amp;quot;)&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;twice. The&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;cov2cor&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#160;function is even a bit more efficient, and provided mostly for didactical reasons.&lt;/span&gt;&lt;/p&gt;&lt;div&gt;&lt;span class=&quot;c2&quot;&gt;Value&lt;/span&gt;&lt;/div&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span class=&quot;c4&quot;&gt;For&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;r &amp;lt;- cor(*, use = &amp;quot;all.obs&amp;quot;)&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;, it is now guaranteed that&amp;#160;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;all(abs(r) &amp;lt;= 1)&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c4&quot;&gt;.&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;" RHelpText="help(cor, package=stats)" Background="#FFEDEFFF" xmlns="clr-namespace:BSky.Controls;assembly=BSky.Controls" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation"><BSkySourceList CanExecute="True" Syntax="%%VALUE%%" summaryCtrl="False" PrefixTxt="{x:Null}" SepCharacter="{x:Null}" maxNoOfVariables="" SubstituteSettings="NoPrefix|UseComma" ordlevels="" nomlevels="" Name="svarbox1" AutoVar="False" renderVars="False" Filter="String|Numeric|Date|Logical|Ordinal|Nominal|Scale" Width="153" Height="196" Left="8" Top="29" Enabled="True" OverwriteSettings="{x:Null}" MoveVariables="True" SelectionMode="Extended"  AllowDrop="True" IsEnabled="True" Focusable="True" av:Canvas.Left="8" av:Canvas.Top="29" av:Grid.IsSharedSizeScope="True"><BSkySourceList.SelectionChangeBehaviour><BehaviourCollection Capacity="0" /></BSkySourceList.SelectionChangeBehaviour><BSkySourceList.Template><av:ControlTemplate TargetType="av:ListBox"><av:Border BorderThickness="1,1,1,1" CornerRadius="4,4,4,4" BorderBrush="#FF888888" Background="#FFFFFFFF"><av:ScrollViewer Margin="1,1,1,1" Focusable="False"><av:StackPanel IsItemsHost="True" Margin="0,0,0,0" /></av:ScrollViewer></av:Border></av:ControlTemplate></BSkySourceList.Template><BSkySourceList.Style><av:Style TargetType="av:ListBox"><av:Style.Resources><av:ResourceDictionary /></av:Style.Resources><av:Setter Property="av:UIElement.Effect"><av:Setter.Value><av:DropShadowEffect Color="#FFF5F5DC" /></av:Setter.Value></av:Setter></av:Style></BSkySourceList.Style></BSkySourceList><BSkyTargetList CanExecute="False" Syntax="%%VALUE%%" summaryCtrl="False" PrefixTxt="{x:Null}" SepCharacter="{x:Null}" maxNoOfVariables="" SubstituteSettings="NoPrefix|UseComma|Enclosed" ordlevels="" nomlevels="" Name="tvarbox1" AutoVar="True" renderVars="False" Filter="Numeric|Scale" Width="170" Height="138" Left="201" Top="28" Enabled="True" OverwriteSettings="{x:Null}" MoveVariables="True" SelectionMode="Extended"  AllowDrop="True" IsEnabled="True" Focusable="True" av:Canvas.Left="201" av:Canvas.Top="28" av:Grid.IsSharedSizeScope="True"><BSkyTargetList.SelectionChangeBehaviour><BehaviourCollection Capacity="4"><Behaviour><Behaviour.Condition><Condition PropertyName="ItemsCount" Value="2" Operator="LessThan" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="tvarbox1" PropertyName="CanExecute" Value="FALSE" /></PropertySettersCollection></Behaviour.Setters></Behaviour><Behaviour><Behaviour.Condition><Condition PropertyName="ItemsCount" Value="1" Operator="GreaterThan" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="tvarbox1" PropertyName="CanExecute" Value="True" /></PropertySettersCollection></Behaviour.Setters></Behaviour></BehaviourCollection></BSkyTargetList.SelectionChangeBehaviour><BSkyTargetList.Template><av:ControlTemplate TargetType="av:ListBox"><av:Border BorderThickness="1,1,1,1" CornerRadius="4,4,4,4" BorderBrush="#FF888888" Background="#FFFFFFFF"><av:ScrollViewer Margin="1,1,1,1" Focusable="False"><av:StackPanel IsItemsHost="True" Margin="0,0,0,0" /></av:ScrollViewer></av:Border></av:ControlTemplate></BSkyTargetList.Template><BSkyTargetList.Style><av:Style TargetType="av:ListBox"><av:Style.Resources><av:ResourceDictionary /></av:Style.Resources><av:Setter Property="av:UIElement.Effect"><av:Setter.Value><av:DropShadowEffect Color="#FFF5F5DC" /></av:Setter.Value></av:Setter></av:Style></BSkyTargetList.Style></BSkyTargetList><BSkyLabel Name="svar1" Text="Source Variables" Width="103" Height="26" Left="5" Top="3" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="5" av:Canvas.Top="3">Source Variables</BSkyLabel><BSkyLabel Name="tvar1" Text="Selected Variables (at least two)" Width="177" Height="24" Left="198" Top="4" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="198" av:Canvas.Top="4">Selected Variables (at least two)</BSkyLabel><BSkyVariableMoveButton Name="mov1" InputList="svarbox1" TargetList="tvarbox1" Width="30" Height="30" Left="165" Top="27" Padding="1,1,1,1" Tag="To Dest" Margin="2,2,2,2" av:Canvas.Left="165" av:Canvas.Top="27"><BSkyVariableMoveButton.Effect><av:DropShadowEffect ShadowDepth="0" Color="#C89B5F00" Direction="320" Opacity="1" /></BSkyVariableMoveButton.Effect><av:Grid><av:Image Source="pack://application:,,,/BSky.Controls;component/Resources/left.png" /></av:Grid></BSkyVariableMoveButton><BSkyRadioGroup Name="gpbox2" HeaderText="Select Only One" Text="{x:Null}" Width="170" Height="54" Left="201" Top="172" Syntax="%%VALUE%%" Header="Select Only One" BorderBrush="#FFA9A9A9" IsHitTestVisible="True" av:Canvas.Left="201" av:Canvas.Top="172"><BSkyRadioGroup.RadioButtons><x:Null /></BSkyRadioGroup.RadioButtons><av:StackPanel><BSkyRadioButton GroupName="gpbox2" Name="test1" Text="Pearson Product-Moment" Width="Auto" Left="0" Top="0" Height="Auto" IsSelected="True" CanExecute="True" Enabled="True" Syntax="pearson" IsChecked="True" FontFamily="Segoe UI" FontSize="12" Style="{av:DynamicResource RadioButtonTemplate}" IsEnabled="True"><BSkyRadioButton.CheckedChangeBehaviour><BehaviourCollection Capacity="0" /></BSkyRadioButton.CheckedChangeBehaviour>Pearson Product-Moment</BSkyRadioButton><BSkyRadioButton GroupName="gpbox2" Name="test2" Text="Spearman Rank-Order" Width="Auto" Left="0" Top="0" Height="Auto" IsSelected="False" CanExecute="True" Enabled="True" Syntax="spearman" IsChecked="False" FontFamily="Segoe UI" FontSize="12" Style="{av:DynamicResource RadioButtonTemplate}" IsEnabled="True"><BSkyRadioButton.CheckedChangeBehaviour><BehaviourCollection Capacity="0" /></BSkyRadioButton.CheckedChangeBehaviour>Spearman Rank-Order</BSkyRadioButton></av:StackPanel></BSkyRadioGroup><BSkyLabelReqdField Name="rq1" Text="*" Width="15" Height="25" Left="367" Top="0" CanExecute="False" Foreground="#FFFF0000" FontFamily="Segoe UI" FontSize="12" FontWeight="Bold" av:Canvas.Left="367" av:Canvas.Top="0">*</BSkyLabelReqdField></BSkyCanvas>