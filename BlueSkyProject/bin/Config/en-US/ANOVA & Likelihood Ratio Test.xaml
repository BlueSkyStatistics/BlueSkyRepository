<BSkyCanvas internalhelpfilename="{x:Null}" Title="Anova &amp; Likelihood Ratio Test" ModelClasses="{x:Null}" StatusTextBoxName="{x:Null}" customsyntax="{x:Null}" EditableComboBoxName="modelselector1" RPackages="lmtest" CanExecute="True" PrereqCommandString="BSkyGetAvailableModels(c(&quot;lm&quot;, &quot;glm&quot;, &quot;coxph&quot;, &quot;gls&quot;, &quot;lme&quot;,&quot;loglm&quot;, &quot;negbin&quot;, &quot;survreg&quot;,&quot;lmerModLmerTest&quot;), returnClassTrain=TRUE)" CommandString="local ({&#xA;modclass=&quot;&quot;&#xA;originalmodelclass=class({{modelselector1}})&#xA;title = &quot;Results of running ANOVA&quot;&#xA;if ( &quot;train&quot; %in% class({{modelselector1}}))&#xA;{&#xA;{{modelselector1}} &lt;-{{modelselector1}}$finalModel&#xA;modclass = class({{modelselector1}}$finalModel)&#xA;}&#xA;else&#xA;{&#xA;modclass = class({{modelselector1}})&#xA;}&#xA;&#xA;&#xA;if ( &quot;glm&quot; %in% modclass  )&#xA;{&#xA;title = &quot;Results of running ANOVA with Chisq Test&quot;&#xA;anovaResults &lt;-anova({{modelselector1}},  test =&quot;Chisq&quot;)&#xA;BSkyFormat(as.data.frame(anovaResults), singleTableOutputHeader = title)&#xA;}&#xA;else if (&quot;lmerModLmerTest&quot; %in% modclass  )&#xA;{&#xA;title1 = &quot;Omnibus Tests for Fixed Effects&quot;&#xA;title2 = &quot;Omnibus Tests for Random Effects&quot;&#xA;anovaResults &lt;-anova({{modelselector1}})&#xA;randomEffectResults &lt;-ranova({{modelselector1}})&#xA;BSkyFormat(as.data.frame(anovaResults),singleTableOutputHeader = title1)&#xA;BSkyFormat(as.data.frame(randomEffectResults),singleTableOutputHeader = title2)&#xA;}&#xA;else&#xA;{&#xA;anovaResults &lt;-anova({{modelselector1}})&#xA;BSkyFormat(as.data.frame(anovaResults), singleTableOutputHeader = title)&#xA;}&#xA;&#xA;&#xA;#Likelihood ratio test is not run for models of class train created via Model Tuning, loess and linear models with generalized least squares&#xA;if ( !(&quot;train&quot;  %in% originalmodelclass ) &amp;&amp; !(&quot;loess&quot; %in% modclass || &quot;gls&quot; %in% modclass || &quot;lmerModLmerTest&quot; %in% modclass) )&#xA;{&#xA;lrtestResults &lt;- lmtest::lrtest({{modelselector1}})&#xA;BSkyFormat(as.data.frame(lrtestResults), singleTableOutputHeader = &quot;Likelihood Ratio Test&quot;)&#xA;}&#xA;}&#xA;)" dlgsyntax="local ({&#xA;modclass=&quot;&quot;&#xA;originalmodelclass=class({{modelselector1}})&#xA;title = &quot;Results of running ANOVA&quot;&#xA;if ( &quot;train&quot; %in% class({{modelselector1}}))&#xA;{&#xA;{{modelselector1}} &lt;-{{modelselector1}}$finalModel&#xA;modclass = class({{modelselector1}}$finalModel)&#xA;}&#xA;else&#xA;{&#xA;modclass = class({{modelselector1}})&#xA;}&#xA;&#xA;&#xA;if ( &quot;glm&quot; %in% modclass  )&#xA;{&#xA;title = &quot;Results of running ANOVA with Chisq Test&quot;&#xA;anovaResults &lt;-anova({{modelselector1}},  test =&quot;Chisq&quot;)&#xA;BSkyFormat(as.data.frame(anovaResults), singleTableOutputHeader = title)&#xA;}&#xA;else if (&quot;lmerModLmerTest&quot; %in% modclass  )&#xA;{&#xA;title1 = &quot;Omnibus Tests for Fixed Effects&quot;&#xA;title2 = &quot;Omnibus Tests for Random Effects&quot;&#xA;anovaResults &lt;-anova({{modelselector1}})&#xA;randomEffectResults &lt;-ranova({{modelselector1}})&#xA;BSkyFormat(as.data.frame(anovaResults),singleTableOutputHeader = title1)&#xA;BSkyFormat(as.data.frame(randomEffectResults),singleTableOutputHeader = title2)&#xA;}&#xA;else&#xA;{&#xA;anovaResults &lt;-anova({{modelselector1}})&#xA;BSkyFormat(as.data.frame(anovaResults), singleTableOutputHeader = title)&#xA;}&#xA;&#xA;&#xA;#Likelihood ratio test is not run for models of class train created via Model Tuning, loess and linear models with generalized least squares&#xA;if ( !(&quot;train&quot;  %in% originalmodelclass ) &amp;&amp; !(&quot;loess&quot; %in% modclass || &quot;gls&quot; %in% modclass || &quot;lmerModLmerTest&quot; %in% modclass) )&#xA;{&#xA;lrtestResults &lt;- lmtest::lrtest({{modelselector1}})&#xA;BSkyFormat(as.data.frame(lrtestResults), singleTableOutputHeader = &quot;Likelihood Ratio Test&quot;)&#xA;}&#xA;}&#xA;)" Helpfile="{x:Null}" splitProcessing="False" DatasetRequired="True" MenuLocation="{x:Null}" OutputDefinition="" Width="504" Command="False" Height="340" HelpText="&lt;html&gt;&lt;head&gt;&lt;style type=&quot;text/css&quot;&gt;.c0 { color: Black } .c1 { margin: 0px 0px 10px } .c2 { font-weight: bold; font-size: 16px } .c3 { line-height: 1.07; font-size: 16px; font-family: 'Calibri','Arial'; font-weight: bold } .c4 { line-height: 1.07; font-size: 14.6666666666667px; font-family: 'Calibri','Arial' } .c5 { font-weight: bold; line-height: 1.15; font-size: 14.6666666666667px; font-family: 'Calibri','Trebuchet MS' } .c6 { margin: 0px 0px 10px; line-height: 1.15; font-size: 14.6666666666667px; font-family: 'Calibri','Trebuchet MS' } .c7 { font-weight: bold } .c8 { font-weight: normal } .c9 { font-weight: normal; line-height: 1.15; font-size: 14.6666666666667px; font-family: 'Calibri','Trebuchet MS' } .c10 { line-height: 1.15; font-size: 18.6666666666667px; font-family: 'Calibri','Trebuchet MS' } .c11 { line-height: 1.15; font-size: 16px; font-family: 'Calibri','Trebuchet MS' } .c12 { line-height: 1.15; font-size: 16px; font-family: 'Calibri','Trebuchet MS'; font-weight: normal } .c13 { font-size: 16px } &lt;/style&gt;&lt;/head&gt;&lt;body class=&quot;c0&quot;&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span&gt;&lt;span&gt;&lt;span class=&quot;c2&quot;&gt;Computes analysis of variance tables and performs likelihood ratio tests for a fitted model object.&amp;#160;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c2&quot;&gt;&amp;#160;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c3&quot;&gt;For Mixed effects models, the ANOVA-like table for random effects is displayed&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c4&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span&gt;&amp;#x200b;&lt;span&gt;&lt;span class=&quot;c2&quot;&gt;Anova Tables&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c1&quot;&gt;&lt;span&gt;&amp;#x200b;&lt;span&gt;&lt;span class=&quot;c5&quot;&gt;Description:&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;Compute analysis of variance (or deviance) tables for one or more fitted model objects.&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;Usage:&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;anova(object, ...)&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;Arguments&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;object: &amp;#160;an object containing the results returned by a model fitting function (e.g., lm or glm).&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;Value&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c8&quot;&gt;This (generic) function returns an object of class anova. These objects represent analysis-of-variance and analysis-of-deviance tables. When given a single argument it produces a table which tests whether the model terms are significant. When given a sequence of objects, anova tests the models against one another in the order specified.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c8&quot;&gt;The print method for anova objects prints tables in a ‘pretty’ form.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;Warning&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c8&quot;&gt;The comparison between two or more models will only be valid if they are fitted to the same dataset. This may be a problem if there are missing values and R's default of na.action = na.omit is used.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;References&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c8&quot;&gt;Chambers, J. M. and Hastie, T. J. (1992) Statistical Models in S, Wadsworth &amp;amp; Brooks/Cole.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;Package:&amp;#160;&lt;span&gt;&lt;span class=&quot;c8&quot;&gt;stats&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c5&quot;&gt;Other:&amp;#160;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c9&quot;&gt;help(anova)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c9&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c10&quot;&gt;Likelihood Ratio Test of Nested Models&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c11&quot;&gt;Description&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;lrtest is a generic function for carrying out likelihood ratio tests. The default method can be employed for comparing nested (generalized) linear models (see details below).&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c11&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c11&quot;&gt;Usage&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;&amp;#160;lrtest(object, ...)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;span&gt;&lt;span class=&quot;c12&quot;&gt;&amp;#160;## Default S3 method:&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;lrtest(object, ..., name = NULL)&amp;#160;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;span&gt;&lt;span class=&quot;c12&quot;&gt;&amp;#160;## S3 method for class 'formula'&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;lrtest(object, ..., data = list())&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c11&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c11&quot;&gt;Arguments&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;object:&amp;#160;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;an object. See below for details.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;span&gt;&lt;span class=&quot;c12&quot;&gt;...&amp;#160;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;further object specifications passed to methods. See below for details.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;span&gt;&lt;span class=&quot;c12&quot;&gt;name:&amp;#160;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;a function for extracting a suitable name/description from a fitted model object. By default the name is queried by calling formula.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;span&gt;&lt;span class=&quot;c12&quot;&gt;data:&amp;#160;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;a data frame containing the variables in the model.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c11&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c11&quot;&gt;Details&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;lrtest is intended to be a generic function for comparisons of models via asymptotic likelihood ratio tests. The default method consecutively compares the fitted model object object with the models passed in .... Instead of passing the fitted model objects in ..., several other specifications are possible. The updating mechanism is the same as for waldtest: the models in ... can be specified as integers, characters (both for terms that should be eliminated from the previous model), update formulas or fitted model objects. Except for the last case, the existence of an update method is assumed. See waldtest for details.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;span&gt;&lt;span class=&quot;c12&quot;&gt;Subsequently, an asymptotic likelihood ratio test for each two consecutive models is carried out: Twice the difference in log-likelihoods (as derived by the logLik methods) is compared with a Chi-squared distribution.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;span&gt;&lt;span class=&quot;c12&quot;&gt;The &amp;quot;formula&amp;quot; method fits a lm first and then calls the default method.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c11&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c11&quot;&gt;Value&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;An object of class &amp;quot;anova&amp;quot; which contains the log-likelihood, degrees of freedom, the difference in degrees of freedom, likelihood ratio Chi-squared statistic and corresponding p value.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c11&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c11&quot;&gt;See Also&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;waldtest&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c11&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c11&quot;&gt;Examples&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;## with data from Greene (1993):&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;## load data and compute lags&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;data(&amp;quot;USDistLag&amp;quot;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;usdl &amp;lt;- na.contiguous(cbind(USDistLag, lag(USDistLag, k = -1)))&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;colnames(usdl) &amp;lt;- c(&amp;quot;con&amp;quot;, &amp;quot;gnp&amp;quot;, &amp;quot;con1&amp;quot;, &amp;quot;gnp1&amp;quot;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;fm1 &amp;lt;- lm(con ~ gnp + gnp1, data = usdl)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;fm2 &amp;lt;- lm(con ~ gnp + con1 + gnp1, data = usdl)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;## various equivalent specifications of the LR test&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;lrtest(fm2, fm1)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;lrtest(fm2, 2)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;lrtest(fm2, &amp;quot;con1&amp;quot;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;lrtest(fm2, . ~ . - con1)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c11&quot;&gt;ANOVA-Like Table for Random-Effects&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c11&quot;&gt;Description&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;Compute an ANOVA-like table with tests of random-effect terms in the model. Each random-effect term is reduced or removed and likelihood ratio tests of model reductions are presented in a form similar to that of drop1. rand is an alias for ranova.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c11&quot;&gt;Usage&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;ranova(model, reduce.terms = TRUE, ...)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;rand(model, reduce.terms = TRUE, ...)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c11&quot;&gt;Arguments&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;model: a linear mixed effect model fitted with lmer() (inheriting from class lmerMod).&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c12&quot;&gt;reduce.terms: if TRUE (default) random-effect terms are reduced (if possible). If FALSE random-effect terms are simply removed.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c11&quot;&gt;Details&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;If the model is fitted with REML the tests are REML-likelihood ratio tests.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c12&quot;&gt;A random-effect term of the form (f1 + f2 | gr) is reduced to terms of the form (f2 | gr) and (f1 | gr) and these reduced models are compared to the original model. If reduce.terms is FALSE (f1 + f2 | gr) is removed instead.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c12&quot;&gt;A random-effect term of the form (f1 | gr) is reduced to (1 | gr) (unless reduce.terms is FALSE).&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c12&quot;&gt;A random-effect term of the form (1 | gr) is not reduced but simply removed.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c12&quot;&gt;A random-effect term of the form (0 + f1 | gr) or (-1 + f1 | gr) is reduced (if reduce.terms = TRUE) to (1 | gr).&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c12&quot;&gt;A random-effect term of the form (1 | gr1/gr2) is automatically expanded to two terms: (1 | gr2:gr1) and (1 | gr1) using findbars.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c12&quot;&gt;In this exposition it is immaterial whether f1 and f2 are factors or continuous variables.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c11&quot;&gt;Value&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;an ANOVA-like table with single term deletions of random-effects inheriting from class anova and data.frame with the columns:&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c12&quot;&gt;npar:&amp;#160;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;number of model parameters.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c12&quot;&gt;logLik:&amp;#160;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;the log-likelihood for the model. Note that this is the REML-logLik if the model is fitted with REML.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c12&quot;&gt;AIC:&amp;#160;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;the AIC for the model evaluated as -2*(logLik - npar). Smaller is better.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c12&quot;&gt;LRT:&amp;#160;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;the likelihood ratio test statistic; twice the difference in log-likelihood, which is asymptotically chi-square distributed.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c12&quot;&gt;Df:&amp;#160;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;degrees of freedom for the likelihood ratio test: the difference in number of model parameters.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c12&quot;&gt;Pr(&amp;gt;Chisq) :&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;the p-value.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c11&quot;&gt;Warning&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;In certain cases tests of non-nested models may be generated. An example is when (0 + poly(x, 2) | gr) is reduced (the default) to (1 | gr). To our best knowledge non-nested model comparisons are only generated in cases which are statistical nonsense anyway (such as in this example where the random intercept is suppressed).&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c11&quot;&gt;Note&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;Note that anova can be used to compare two models and will often be able to produce the same tests as ranova. This is, however, not always the case as illustrated in the examples.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c11&quot;&gt;Author(s)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;Rune Haubo B. Christensen and Alexandra Kuznetsova&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c5&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;/span&gt;&lt;span class=&quot;c11&quot;&gt;Package&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c5&quot;&gt;&lt;span class=&quot;c12&quot;&gt;lmerTest&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c13&quot;&gt;Help&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span&gt;help(ranova, package ='lmerTest')&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c11&quot;&gt;See Also&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;drop1 for tests of marginal fixed-effect terms and anova for usual anova tables for fixed-effect terms.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c11&quot;&gt;Examples&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span&gt;&lt;span class=&quot;c7&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;c12&quot;&gt;# Test reduction of (Days | Subject) to (1 | Subject):&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;fm1 &amp;lt;- lmer(Reaction ~ Days + (Days|Subject), sleepstudy)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;ranova(fm1) # 2 df test&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;# This test can also be achieved with anova():&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;fm2 &amp;lt;- lmer(Reaction ~ Days + (1|Subject), sleepstudy)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;anova(fm1, fm2, refit=FALSE)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;# Illustrate reduce.test argument:&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;# Test removal of (Days | Subject):&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;ranova(fm1, reduce.terms = FALSE) # 3 df test&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;# The likelihood ratio test statistic is in this case:&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;fm3 &amp;lt;- lm(Reaction ~ Days, sleepstudy)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;2*c(logLik(fm1, REML=TRUE) - logLik(fm3, REML=TRUE)) # LRT&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;# anova() is not always able to perform the same tests as ranova(),&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;# for example:&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;anova(fm1, fm3, refit=FALSE) # compares REML with ML and should not be used&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;anova(fm1, fm3, refit=TRUE) # is a test of ML fits and not what we seek&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;# Also note that the lmer-fit needs to come first - not an lm-fit:&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;# anova(fm3, fm1) # does not work and gives an error&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;&amp;#x200b;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;# ranova() may not generate all relevant test:&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;# For the following model ranova() indicates that we should not reduce&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;# (TVset | Assessor):&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;fm &amp;lt;- lmer(Coloursaturation ~ TVset * Picture + (TVset | Assessor), data=TVbo)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;ranova(fm)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;# However, a more appropriate model is:&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;fm2 &amp;lt;- lmer(Coloursaturation ~ TVset * Picture + (1 | TVset:Assessor), data=TVbo)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;anova(fm, fm2, refit=FALSE)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;# fm and fm2 has essentially the same fit to data but fm uses 5 parameters&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;c6&quot;&gt;&lt;span class=&quot;c7&quot;&gt;&lt;span class=&quot;c12&quot;&gt;# more than fm.&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;" RHelpText="help(lrtest, package=&quot;lmtest&quot;)" Background="#FFFFFFFF" xmlns="clr-namespace:BSky.Controls;assembly=BSky.Controls" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation"><BSkyEditableComboBox Name="modelselector1" DefaultSelection="" NothingSelected="{x:Null}" prefixSelectedValue="" Width="125" Height="25" Left="121.466666666667" Top="240" CanExecute="True" Enabled="True" Syntax="%%VALUE%%" IsEditable="True" Text="" IsEnabled="True" av:Canvas.Left="121.466666666667" av:Canvas.Top="240"><BSkyEditableComboBox.ComboBoxEntries><x:Null /></BSkyEditableComboBox.ComboBoxEntries><BSkyEditableComboBox.SelectionChangeBehaviour><BehaviourCollection Capacity="0" /></BSkyEditableComboBox.SelectionChangeBehaviour></BSkyEditableComboBox><BSkyLabel Name="lab2" Text="Select a model:" Width="110.733333333333" Height="25.0666666666667" Left="3" Top="240" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="3" av:Canvas.Top="240">Select a model:</BSkyLabel><BSkyLabel Name="laby" Text="Linear models (lm)" Width="123.333333333333" Height="28" Left="3" Top="30" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="3" av:Canvas.Top="30">Linear models (lm)</BSkyLabel><BSkyLabel Name="wa" Text="ANOVA is performed for models with classes below (R classes are listed in parenthesis below)" Width="540.4" Height="31.6" Left="3" Top="10" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="3" av:Canvas.Top="10">ANOVA is performed for models with classes below (R classes are listed in parenthesis below)</BSkyLabel><BSkyLabel Name="ww" Text="Generalized linear models (glm)" Width="200" Height="30" Left="3" Top="50" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="3" av:Canvas.Top="50">Generalized linear models (glm)</BSkyLabel><BSkyLabel Name="ee" Text="Linear mixed effects models (lme)" Width="196" Height="26" Left="3" Top="70" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="3" av:Canvas.Top="70">Linear mixed effects models (lme)</BSkyLabel><BSkyLabel Name="uu" Text="Negative-binomial log linear model (negbin)" Width="253" Height="28" Left="3" Top="90" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="3" av:Canvas.Top="90">Negative-binomial log linear model (negbin)</BSkyLabel><BSkyLabel Name="ll" Text="Survival regression model (survreg)" Width="210.8" Height="26.8" Left="3" Top="130" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="3" av:Canvas.Top="130">Survival regression model (survreg)</BSkyLabel><BSkyLabel Name="mm" Text="Proportional hazard model (coxph)" Width="200.4" Height="25.8" Left="3" Top="150" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="3" av:Canvas.Top="150">Proportional hazard model (coxph)</BSkyLabel><BSkyLabel Name="kjh" Text="Linear model using generalized least squares (gls)" Width="279" Height="29" Left="3" Top="110" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="3" av:Canvas.Top="110">Linear model using generalized least squares (gls)</BSkyLabel><BSkyLabel Name="wsx" Text="Note: If the model list is empty please create a model, see top level menu Model Fitting " Width="472" Height="27.9999999999999" Left="3" Top="270" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="3" av:Canvas.Top="270" xml:space="preserve">Note: If the model list is empty please create a model, see top level menu Model Fitting </BSkyLabel><BSkyLabel Name="qaw" Text="and Model Tuning to create a model" Width="202.8" Height="28.9999999999999" Left="3" Top="290" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="3" av:Canvas.Top="290">and Model Tuning to create a model</BSkyLabel><BSkyLabel Name="rte" Text="**NOTE: Likelihood test is not supported for models created via Model Tuning (class train)," Width="490.8" Height="25.8" Left="3" Top="190" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="3" av:Canvas.Top="190">**NOTE: Likelihood test is not supported for models created via Model Tuning (class train),</BSkyLabel><BSkyLabelReqdField Name="oim" Text="*" Width="15" Height="25" Left="85.2" Top="233" CanExecute="False" Foreground="#FFFF0000" FontFamily="Segoe UI" FontSize="12" FontWeight="Bold" av:Canvas.Left="85.2" av:Canvas.Top="233">*</BSkyLabelReqdField><BSkyLabel Name="wqa" Text="and not applicable for Loess regression (loess) and generalized least squares." Width="422" Height="25.8" Left="3" Top="206" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="3" av:Canvas.Top="206">and not applicable for Loess regression (loess) and generalized least squares.</BSkyLabel><BSkyLabel Name="bbb" Text="Loess regression (loess)" Width="169.2" Height="28.2" Left="3" Top="169.4" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="3" av:Canvas.Top="169.4">Loess regression (loess)</BSkyLabel></BSkyCanvas>